[
["index.html", "心理科學基礎統計 前言", " 心理科學基礎統計 陳紹慶 Sau-Chin Chen 2019-05-05 前言 第一版前言(2018.2.1) 開始寫這本書有很多緣由，就從遠中近三個時間點的感想來說吧。遠因從我還是大學生小毛頭時開始，那時真正體悟學習統計的要訣，是去聽了幾位老師的授課，自行整理筆記得到收穫。當時讀過的幾本中英文教科書，最後成為案頭書的只有Roger Kirk的Experimental Design。到今天要我推薦初學者值得參考的中文書，我完全無法舉出理想的教材，除非學生有興趣透過學習資料科學入門，才有值得推薦的中文線上教材。 中程因素是2016年翻譯了Daniel Lakens的線上課程提昇你的統計推論功力(Improving your statistical inferences)，我體會可以從培養學習者的思考實際問題能力，激發學習統計方法的動機，並且掌握正確的資訊。Daniel 使用的教材是近幾年引發心理學再現危機的指標研究，都有公開資料讓人取用。曉得這些研究背後故事，有助如何正確使用統計方法。 但是對於統計的初學者，甚至是心理學的初學者，這些故事還無法引起這些學習者的共鳴。如何激起初級學習者的學習興趣，並指引他們走上正確的學習道路，就是寫這本書的近因。這個任務有幾個要挑戰的目標：首先是使用能引發初學者興趣的案例，每一個世代的入門學習者特有特殊的共同記憶，形成不同的大眾興趣。這也帶來第二個挑戰，如何保持編寫教材的中心思想，又能時俱進引用有吸引力的案例？引導初學者認識開放科學理念與操作方法，是累積高品質研究的基礎。所以我編輯這套入門統計教材，希望協助初學者找到適合自已的學習門徑，能在幾個月之後有能力學習提昇你的統計推論功力等進階課程。 所幸已經出現許多公開資源，讓我有面對這些挑戰的機會。編輯這本電子書R套件的bookdwon，能整合各種有助學習的互動式材料於多種平台。新世代資料科學家提供的自由整合資源，降低學習者掌握統計觀念的門檻。特別感激年輕的史丹福大學研究生Daniel Kunin，與朋友一起花時間開發，又無私分享的seeing theory，讓這本書能嘗試傳統教科書做不到的互動學習。開源又潛力無窮的統計軟體JASP與jamovi，學習者容易上手，又是資料分析工作的實用工具。兩套開源軟體與科學研究開放平台Open Science Framework密切整合，能彈性管理延伸學習材料。這本書的示範檔案，以及各單元習題，都發佈於心理科學基礎統計OSF專案，任何人有需要，不必註冊，可直接取用專案中的學習材料。 本書取用的示範與習題案例，都是可檢索論文全文與原始資料的研究，初始版本的案例主要來自Carlson與Winquist合著的教科書“An Introduction to Statistics: an Active Learning Approach”(Carlson and Winquist 2018)，以及收集推特與臉書社團Psychological Methods Discussion Group，可以啟發初學者的案例。習題也是使用有公開資料的研究。編寫這本書時候，我正在研發一套習題模板，方便管理與擴充各單元的資源。我更希望有意充實這套教材的朋友與同學們，可以提供您認為值得學習的材料。 所有材料都不斷持續更新中，希望體現我想傳達給統計學習者與使用者我的學習觀：你今天學到的方法，是為了解決明天出現的新問題，而且會用另一種不同的面貌出現。 第二版前言(2019.1.3) 完成第一版之後的一年之間，更新版的JASP與jamovi除了增加資料處理與統計方法模組，還有整合各種開放學習資源。我曾於個人網誌整理可運用的資源，2018年最後一次的更新，JSAP與jamovi的資料收藏(Data Library)都大幅擴充，教學有更多範例可以使用。這段期間jamovi套件Statkat發佈，提供使用者即時統計方法諮詢。循此我得和套件開發者Rivka. M. de Vries先行建置的網站[https://statkat.com/]，內容與架構符合我心目中的統計教學應具備的樣子。jamovi首席開發者Jonathon Love釋出的Rj，讓使用者能在jamovi裡操作基本的R程式碼，這個套件能更完整呈現與演練機率的計算與模擬。這些更新讓這一版電子書使用更明確的範例，解說統計方法的機率原理，以及運用間斷–連續變項的對比，介紹適用相對狀況的初級推論統計方法。 這一版與前一版保持每個範例與習題都有JASP與jamovi兩種版本。感謝jamovi可執行R程式碼，前一版以嵌入式互動網頁解說機率原理的部分，儘可能以本人自編的jamovi範例檔取代，讓學習者能運用在個人練習與實務。 References "],
["intro.html", "第1單元 統計思考開門 1.1 統計思考實例：Emily Rosa的專題研究 1.2 統計思考養成途徑 1.3 統計方法運用指南 1.4 總結 1.5 習題", " 第1單元 統計思考開門 科學創見從對現象的推測開始，只要好奇親眼目睹或耳聞的現象之發生原因，推測如何發生的過程，就有最初步的假設(Hypothesis)。假設要成為讓人信服的說法，需要有正面證據(Positive Evidence)的支持，以及不被反面證據(Negative Evidence)推翻。決定該找到什麼樣的證據，還有收集證據的方法，與假設放在一起就構成科學思考(Scientific thinking)。當證據是需要經過隨機化(Randomization)取得的資料(Data)，並且使用機率模型(Probability Model)整理與驗證資料裡的正反面訊息，這種科學思考就是統計思考(Statistical Thinking)。 1.1 統計思考實例：Emily Rosa的專題研究 曾擔任美國神智學會(Theosophical Society in America)會長的Dora Kunz在1970年代起提倡治療性撫慰(therapeutic touch)，幫助病患紓解病痛與焦慮。提倡者主張人類身體自然散發能量場(energy field)，受過訓練的治療師能不接觸患者身體，感應患者的能量場，並運用自身能量撫慰患部，紓解病患的痛苦。到了今天，包括美國在內，全球大約有80所護理學校列治療性撫慰為正式課程，光是北美地區有80所左右的醫療機構允許護理人員使用治療性撫慰幫助住院患者。有興趣的讀者使用關鍵詞“therapeutic touch”搜尋網路資訊，還能發現有組織定期舉辦教育工作坊。 圖 1.1: 正在接受治療性撫慰的男士。圖像取自HEAVYSTONES.com 1998年當時11歲的美國女孩Emily Rosa，想知道治療師感應人體能量場的真實能力，改造流傳已久的擲硬幣遊戲，設計出一套簡易測試。她請治療師坐在同一張桌子對面，兩人之間有一塊隔板，雖然能對話但是看不見彼此，隔板下方有兩個孔洞。測試時治療師將雙手穿過孔洞伸到另一邊，每次測試前測試者先投擲硬幣，決定要將自已的手伸到治療師的那一隻手掌上方8至10公分處，再請治療師說出測試者的手是在左手還是右手上方，每位治療師反覆進行十次測試。以擲硬幣對賭的所有可能性來看，Emily假設如果治療師真的有感應人體能量場的能力，十次測試的答對率應該比完全亂猜(50%)高出許多，當年的Emily認為一位治療師至少要答對8次，才能證實真有本事。 圖 1.2: 左：Emily Rosa 11歲時的留影，取自維基百科。右：Emily Rosa施測現場素描，取自Rosa et al. (1998) Figure 1 在父母的幫助下，1996年Emily邀請到15位實際從事治療性撫慰的人士參與測試，一年後因為電視台的專訪，又找了曾參與先前研究在內的7位等共13位人士，進行第二次研究。Emily與父母以及一位醫師一起將兩次研究結果寫成論文發表(Rosa et al. 1998)。論文中的長條圖呈現28人次的正確次數，圖1.3是原始統計圖的重製版本： 圖 1.3: Emily Rosa的研究結果 測試結果究竟證實了治療師們真有本事？還是揭露治療性撫慰的誇大不實？回答這些問題之前，我們先來解析這件專題研究的思路。如果你認為Emily Rosa的假設與測試方法是有道理的，或者你認為可以做更好的改良，那麼你已經有科學思考的基本能力。Emily的專題研究讓我們知道，能以科學思考探究的問題，必定有可測試的假設，以及可實作的測試方法。更嚴謹的話，還要加上正反證據的成立條件。 那麼為何Emily Rosa的專題研究是一種統計思考？首先Emily提出的假設有預期測量結果的發生機率：如果治療師們沒有宣稱的本事，全部的答對率應該和丟硬幣猜是正面還是反面向上的機率一樣：50%。如果治療師們真的有本事，答對率應該明顯高於50%，這也是正面證據與反面證據有效的條件。至於Emily使用的測試方法，看上去可以有效累積每位治療師的答對率。 圖 1.3 標示21位治療師的平均答對次數是4.4次，表示10次測試裡有4至5次是正確的。平均4.4次似乎與50%差不了多少，憑這個數值，Emily能推斷這群治療師的本事言過其實嗎？ 1.2 統計思考養成途徑 Emily Rosa的報告裡是以數值呈現的機率資訊，判斷治療師有本事的可能性，有沒有高過治療師沒有本事的可能性。她所收集的資料，能以全部治療師的正確反應次數估計可能性，也可以每位治療師的正確率估計可能性。本書運用這個案例，介紹每位統計初學者首先學習的單一樣本樣本推論統計(第5單元)。 學習第一套推論統計之前，我們要先認識描述資料的方法，也就是描述統計。描述統計的功用是劃清要進行推論的資訊，符合想確證的假設。好的描述統計能展現分析者對問題的理解，以及從資料獲得的判斷。在第2單元，我們將學習類別變數與連續變數的資料尺度以及統計量數，還有表現各種變項組合的統計圖表。 接著在第3單元，我們要重新學習機率事件的計算，以及機率分佈的概念，再次深入了解何謂條件機率，以及運用貝氏定理計算事後機率。到了第4單元，我們要運用程式模擬認識機率分配，探討為何在隨機化條件下收集的資料，才是能代表母群的樣本。這兩個單元都會運用相同的案例，介紹機率的計算與模擬。 充分認識機率的計算與模擬，我們就能運用這些觀念與方法，理解推論統計的運作邏輯。第5單元以TT治療師的測試分析，學習假設檢定的正確運用方法，我們將了解如何考量無窮次的型一與型二錯誤率，謹慎推論一次的顯著性檢定結果；還有初步認識母數推論統計與無母數推論統計的差異。 第6單元將前進到相依樣本的推論統計，在此將認識第一種效果量：標準化平均數差異，以及如何搭配樣本數及考驗力等資訊，判斷推論結果的可靠性。第7單元以獨立樣本的推論統計範例，讓初學者認識實驗設計如何影響分析結果。 第8單元將認識第二種效果量：相關係數，以及最簡單的一元一次線性迴歸式。這個單元的範例與第6單元與第7單元有所關聯，以此引導初學者了解兩種推論方法與變異數分析的關聯性。進入第9單元，就能運用線性迴歸了解正確使用變異數分析的關鍵，以及解讀及呈現分析結果的方式。 1.3 統計方法運用指南 本書編排架構參考Rivka de Vries博士建置的教學網站統計貓咪(statkat)，以分析問題的變項結構設定篇章介紹統計方法。鑑於本書預設讀者是尚未有豐富統計分析實務的初學者，集中介紹適用單一自變項與單一應變項之間，或者只有一個獨變項與一個依變項的統計方法。我將本書介紹的方法，與章節連結整理於下表： 依變項為類別變項 依變項為連續變項 無獨變項 二項檢定( 單元5.3 ) 單一平均數z檢定( 單元?? ) 獨變項為相依樣本 McNemar氏檢定( 單元6.1 ) 相依樣本t檢定(單元6.2) 獨變項為獨立樣本 卡方獨立性檢定(單元7.1) 獨立樣本t檢定(單元7.2) 單一自變項為連續變數 皮爾森相關(單元8.2), 簡單迴歸(單元8.3) 單一獨變項有三組以上獨立樣本 獨立樣本變異數分析(單元9.1) 單一獨變項有三組以上相依樣本 重覆量數變異數分析(單元??) 讀者除了可由表格快速找到自已想查閱的章節資料，這份表格也是統計貓咪(statkat)提供的方法檢索表微型版。當讀者熟練本書介紹的統計方法之後，一旦有需要學習其他統計方法，可經由該網站尋找相關資訊。該如何找到自己需要的統計方法？就要從了解變項的性質開始，所以下一章要好好認識描述統計。 1.4 總結 科學思考講究平等對待正面證據與反面證據；統計思考透過機率模型評估各種證據的可能性。 養成統計思考需要洞察肯定或否定理論的證據皆可能發生，也需要不斷自我提醒，當下得到的結果只是長久觀察的一種可能性。 任何需要統計分析的資料必有依變項，分析之前先確認測量尺度，能掌握合適的分析方法。 1.5 習題 安裝與設定JASP與jamovi。如果電腦有連接網路，由jamovi的模組選單(Modules)，下載試用Rj、statkat、以及learning statistics with jamovi。 根據你的學習指南，開啟指定的JASP與jamovi資料收藏檔案，進行第一次嘗試並儲存分析結果。 註冊OSF與管理管理專案，上傳展示你的第一次分析結果。 References "],
["describe.html", "第2單元 描述統計 2.1 認識資料尺度 2.2 變項的種類 2.3 統計量數 2.4 統計圖表使用指南 2.5 總結 2.6 習題", " 第2單元 描述統計 我們使用2010年芝加哥大學國家民意研究中心(NORC)公開的部分資料SPSS存檔(以下簡種gss2010；存檔下載網址在這個網頁，或者直接點此下載)，做為這個單元的示範案例。JASP與jamovi都可以匯入SPSS存檔，圖2.1是開啟這份存檔之後的畫面1。 圖 2.1: 以JASP開啟GSS 2010存檔資料。 讀者可以看到這份gss2010檔案有五個欄位，每個欄位名稱前面有個圖示，這個圖示標記尺度，決定處理一筆資料的方法。gss2010有名稱的資料欄位，統計實務稱為變項。決定好變項的尺度，我們才能知道要對這筆資料做什麼分析，才能取得我們想知道的資訊。 2.1 認識資料尺度 哈佛大學Stanley Stevens(1946)在Science發表的文章主張測量尺度可分為量化尺度(qunatitative scale)與質化尺度(qualitative scale)，現在的統計實務也稱為連續尺度與間斷尺度。兩種主要尺度之下再細分等比(ratio)與等距(interval)尺度，以及序列(ordinal)及名義(nominal)尺度。尺度的定義已成為今日統計軟體程式設計師的編譯原則，也是資料分析者執行分析程序前要先做好的功課。 連續尺度：當一筆資料內容都是數字，數值有小數點或有超過25種數值，程式都會判定為連續尺度。這類資料的數值之間的差異可以互相比較，例如gss2010的看電視時數(tvhours)以及人生第一胎年齡(AgeFirstBorn)，心理學常見的智力商數(IQ)也是一種連續尺度。許多統計教科書會區分等距尺度與等比尺度，兩者的差別是等比尺度的資料有零點，就像gss2010的科學知識評分(ScientificKnowledge)，這筆資料是受訪者答對問題的題數，註記為0代表沒有答對任何一題。儘管有此差別，兩種尺度的統計實務處理方法通常是一樣的，所以JASP與jamovi都沒有再做分類，JASP圖示是，jamovi圖示是。 間斷尺度(序列)：一筆資料內容都是數字，但是沒有任何數值有小數點，而且在列的數值不超過25種，JASP與jamovi都會判斷為序列尺度(,)。數值表示資料之間的順序，數值的相加或相減沒有意義，例如全班學生某次考試的成績排名。如果序列尺度的變項是分析的目標，通常會計算各種數值的累積百分比。稍後我們會學習計算中位數，是處理序列尺度的主要方法。 間斷尺度(名義)：如果一筆資料的內容都是文字，例如受訪者的性別，居住的城鎮名稱等，JASP與jamovi都會判斷為名義尺度(,)。這類資料的數值只有名稱的區別，不能相加相減，也沒有排序的意義。有時我們丟進軟體的資料內容都是數字，但其實是做為名稱的編號，例如全班學生的學號、受訪者的郵遞區號、最經典的擲硬幣試驗結果。程式無法幫我們判斷這種資料，我們要手動改換尺度圖示為與。稍後我們會學習計算眾數，是處理名義尺度的主要方法。 jamovi 0.9版增加資料型態(Data Type)選項，有Text(文字)、Integer(整數)、Decimal(帶小數點的實數)；以及資料尺度ID。ID必須是Text，Continuous必須是Integer或Decimal，Nomial與Ordinal的資料型態絕對不能是Decimal。 2.2 變項的種類 統計實務處理的資料通常不會只有一個變項，而且各種尺度的變項都會存在。變項越多的資料表示資料收集者希望解答的問題相當複雜，但是有統計思考的資料收集者只會在意那些與測試目標有關的變項。科學思考講究提出有效的證據支持或推翻假設，統計思考要使用合適的方法，確認資料是多有效的證據。了解資料裡每個變項是那種證據要素，才能知道要使用那些方法才適合現在的研究問題。不論你動用統計思考要解決什麼問題，首先要搞清楚那些變項是自變項，那些是依變項。手上資料進入統計思考，就會轉變成可以檢驗的命題。 我們用gss2010資料嘗試回答這個問題：在學校接受教育越多年的民眾，科學知識會不會越豐富？以問題的描述來看，能做證據的資料只有科學知識評分(ScientificKnowledge)與受教年數(YearsofEducation)兩個變項。這個問題可再轉化為分析程序的形式：受教年數能解釋科學知識評分多少程度的提高趨勢？前一種問題描述方式，是有受過中學教育的人們，都能理解的科學思考。後一種問題描述方式，指出分析方法要能顯示科學知識評分的變異趨勢，確實隨受教年數的數值次序提高。 統計思考的命題包含兩種證據要素：命題提及的測量對象可以轉換為統計量數，並且使用動詞與介係詞指示變項之間的關係。統計量數取決於變項的測量尺度，例如gss2010的科學知識評分。命題裡的動詞，或者變項之間的介係詞，都是指示變項之間的關係。例如前面提到gss2010的問題之中「科學知識會不會越豐富」，提示分析統計量數的方式。只要能將問題轉化為統計思考的命題，不論處理的資料有多少變項，資料規模不論大小，變項之間的關係都是根據一組自變項與依變項的對應關係，或者用一組自變項的標記架構依變項資料的分組。前一種變項關係在統計實務是從資料找出最有預測力的迴歸式，後一種變項關係在統計實務是檢驗因果關係的實驗設計。 不管當下的問題要探究的是那一種關係，依變項是可化為統計量數的資料集合，自變項規範呈現統計量數的形式–包括文字與圖表。以gss2010範例問題來說，受教年數是自變項，科學知識評分是依變項。我們有很多方式呈現科學知識評分隨受教年數增加改變的趨勢，其中一種是畫出兩個變項的散佈圖(scatter plot)，因為自變項與依變項的定位，散佈圖的x軸是受教年數，y軸是科學知識評分。圖2.2是JASP與jamovi的操作成果。 圖 2.2: 分析2010年美國一般社會調查，受教年數與科學知識評分的共變散佈圖。左：JASP分析結果；右：jamovi分析結果 你可以看到jamovi輸出比JASP更多的資訊，但是兩套散佈圖都有一條直線，代表每個受教年數的受訪民眾的科學知識評分預測值。預測值明顯隨受教年數增加，表示這筆資料支持在學校接受教育越多年的民眾，科學知識越豐富的看法。這條直線是迴歸線(regression line)，我們將在第8單元學習迴歸線的統計實務。 2.3 統計量數 接下來介紹各種統計實務必定會處理的統計量數，同時示範JASP描述統計模組的基本操作。jamovi的描述統計模組介面設計與操作，和JASP大同小異，所以本章不做另外示範。最常遇到的統計量數有集中趨勢(Central Tendency)與變異趨勢(Dispersion)兩類，在操作示範畫面2.3、2.4與2.5，可以看到模組的功能選單標記這兩類統計量數。這兩種統計量數如何幫助我們解讀資料，請看以下說明。 2.3.1 名義尺度的集中趨勢：眾數 因為前面示範的gss2010沒有精確的名義尺度資料，我們從研究中心網站下載原始gss2010的SPSS存檔，取其中的性別(sex)變項，配合這段示範演練。這個變項資料只有兩種數值：1與2，分別代表男性與女性。從圖2.3的JASP操作與輸出畫面，你可以注意到變項圖示是，表示以數字代表性別，因此報表裡的眾數是2，表示2010年調查的受訪者超過一半是女性。 JASP與jamovi都提供編輯數值標籤(Lable)的，所以我們能另外命名MALE與FEMALE，在長條圖標示每一個長條代表的對象2。 圖 2.3: 使用JASP計算名義尺度變項的眾數與繪製長條圖。 因為眾數(Mode)指示資料之中累積次數最多的數值，所以連續尺度的資料也可以使用眾數分析，但是並非最佳呈現集中趨勢統計量數。 2.3.2 序列尺度的集中趨勢：百分位數與中位數 序列尺度資料的可排序性，構成機率事件可以累加，也可以累積事件的百分比。這種特性讓我們能在實務面計算資料的百分位數(percentile)與中位數(median)，而中位數是集中趨勢的一種。這裡使用gss2010受訪者的受教年數資料做示範，圖2.4示範如何讓JASP輸出三個百分位數(25%,50%,75%)與中位數，以及次數表(frequency table)。 圖 2.4: 使用JASP計算序列尺度變項的中位數、百分位數與繪製長條圖。 圖2.4之中的中位數與50%的百分位數是同一個，對照次數表的資訊，讀者可進一步發現為何是如此：留意靠著次數表右邊的三個欄位Percent、Valid Percent、Cumulative Percent，Percent、Valid Percent都是指示這個數值在這筆資料所佔的百分比，差異是Percent有計算沒有資料的遺漏值(missing value)所佔百分比，Valid Percent是排除遺漏值的計算結果。至於JASP的Cumulative Percent是依數值次序，累加Valid Percent。檢視Cumulative Percent的資訊，你會發現25%百分位數(12)的累進百分比(44.3%)超過前一個數值的累積百分比(17%)，但未到達到50%。50%與75%百分位數的累進百分比同樣如此，而且累進到50%，表示若隨機挑出其中的資料，約50%是小於或等於13的數值，其餘是大於13。所以50%又稱為中位數。 名義尺度與序列尺度資料都可以製作次數表，但是只有序列尺度資料才能計算累積百分比，才能計算中位數與百分位數。序列尺度資料也能計算眾數，讀者可以想想這筆受教年數資料的眾數(12)與中位數(13)，為何會不一樣？ 2.3.3 連續尺度的集中與變異趨勢：平均數、變異數與標準差 我們用gss2010的連續尺度資料：人生第一胎年齡(AgeFirstBorn)示範平均數(Mean)、變異數(Variance)與標準差(Std. Deviation)等統計量數。圖2.5示範除了輸出統計量數應勾選的選項，只要勾選distribution plot，就會繪製直方圖(histogram)。如果讀者夠細心的話，會發現前面示範性別(sex)(圖2.3)也是勾選distribution plot，怎麼繪製出來的是長條圖？這兩個示範的差異顯示JASP與jamovi能根據變項尺度，繪製合理的統計圖。所以分析資料之前，確認每個變項的尺度，是負責分析的人要先做好的工作。直方圖與長條圖都是表現資料內每項數值的對應機率，JASP畫出的直方圖與長條圖都是固定的總面積，再根據資料的累積次數比例切分。只是間斷尺度的累積是不連續的，連續尺度的累積是可連續的。在第3單元，我們會更詳細地認識其中的原理。 圖 2.5: 使用JASP計算連續尺度變項的平均數、變異數、標準差與繪製直方圖。 長條圖裡有一條曲線，曲線之下的面積與長條的面積總合相等，這條曲線是根據JASP計算的機率密度函數(probability density function)所繪，統計實務都用機率密度函數表現連續尺度資料的偏態與峰度，圖2.5的機率密度函數呈現正偏態：越高的數值密度低，所以平均數是三種集中趨勢量數的最大值。而中位數是三種量數的中間值，也是這筆資料沒有偏態時，位於中心的集中量數。 只要在報告中呈現平均數與標準差，有經驗的讀者能理解一筆資料的分配情況。當一筆資料用來推測有沒有不等於某個數值的效應，或者比較多筆資料的差異，平均數與標準差是相當實用的資訊。然而，很多時候我們手上的資料不會是對稱的，最簡單的判斷方法是看平均數、中位數、眾數是不是同一個數值。如果有三種量數有差異，最好要判斷偏態的狀況。在第4單元，我們會學到如何呈現機率密度函數的圖形，以及解讀方法，聰明地運用這些圖形，可以確保推測的正確性。 變異數是標準差的平方(s2)，在分析單一變項資料的實務通常不會報告。然而統計學還沒完全離開數學獨立發展的時代，首先發現的是變異數，接著才是標準差，這在相關與迴歸的單元我們會再談到。最後我們看一個藏在JASP的操作裡的證據，在分析人生第一胎年齡的資料操作，只要勾選Display correlation plot，你會看到JASP輸出和圖2.5一樣的直方圖。 許多處理連續尺度資料的實務裡，我們會將一筆資料的原始數值轉換為標準分數z。方法很簡單：資料裡的每個數值減去平均數，再除以標準差。使用標準分數z有許多好處：首先如果你使用一種尺度，測得好幾筆資料，每筆資料有各自的平均數與標準差，轉換為標準分數就能看出各筆資料之間的差異。推論統計也需要先將原始數值轉換為標準分數，才能運用符合資料特性的機率函數，估計每一筆資料被觀測到的可能性。在推論統計的單元，我們會發現許多推論統計方法要計算的統計數，與標準分數的計算公式非常相似。 2.4 統計圖表使用指南 如何使用合適的統計圖表，表現資料之中的資訊，是計算統計量數之外，另一項描述統計重要功課。選擇適合的統計圖表，原則與選擇合適的推論統計方法一致。我將讀者在各單元範例遇見或製作的統計圖表，與章節連結整理於下表： 依變項為類別變項 依變項為連續變項 無獨變項 圓餅圖(Pie Chart);長條圖(Bar Chart)( 單元5 ) 直方圖(Histograms);密度函數(Density Plot)( 單元5 ) 獨變項為相依樣本 疊加式長條圖;附趨勢線柱狀圖 ( 單元6 ) 次數分配表;附誤差區間折線圖(Line chart)(單元6) 獨變項為獨立樣本 疊加式長條圖;附趨勢線柱狀圖 (單元7) 次數分配表;附誤差區間柱狀圖(Bar plot) (單元7) 單一自變項為連續變數 散佈圖(scattor plot)(單元8) 單一獨變項有三組以上獨立樣本 附誤差區間折線圖(Line chart)(單元9.1) 單一獨變項有三組以上相依樣本 附誤差區間折線圖(Line chart)(單元??) 2.5 總結 資料尺度決定處置每一筆觀察值的方法。 變項賦予每一筆觀察值在統計分析裡的角色。 符合特定尺度的資料能用相對的統計量數計算總成，表現集中趨勢與變異趨勢。 要使用圖表呈現資料，各種尺度有對應的呈現形式，熟悉統計的讀者能判讀資料之中的意義。 2.6 習題 使用jamovi匯入gss2010資料，製作這個單元的JASP示範圖表。 TBA References "],
["probability.html", "第3單元 計算的機率分佈：統計方法的數學基礎 3.1 機率事件計算原理 3.2 條件機率的計算 3.3 機率分佈 3.4 總結 3.5 習題", " 第3單元 計算的機率分佈：統計方法的數學基礎 在這個單元與第4單元，我們將學習到什麼是計算的機率與模擬的機率。計算的機率來自數學領域的機率論，使用數學公式演繹這個世界的隨機現象。從這個單元起介紹的五種機率分佈函數，被統計學家用來開發本書陳列的統計方法。要理解如何運用這些機率分佈函數，需要重新整理機率事件以及條件機率的計算。只要讀者有一定的數學知識，可運用本單元提供的範例與習題，熟練計算的機率。 3.1 機率事件計算原理 3.1.1 集合論 任何能計算機率的事物，必先能定義為集合。例如從一副無鬼牌的撲克牌抽出指定花色及點數的牌組之機率；投擲十枚硬幣，其中五枚正面朝上的機率。這些範例都能列舉集合之內的元素，例如每副撲克牌的花色與點數一共有52種配對；十枚硬幣正面朝上的次數。以十枚硬幣的例子來說，集合之內有十種可能結果，一種結果代表十枚之中正面朝上的硬幣數目。這個集合以大寫字母\\(C\\)代表，其中有11項表列如下： \\(c_1\\): (正、正、正、正、正、正、正、正、正、正) \\(c_2\\): (正、正、正、正、正、正、正、正、正、反) \\(c_3\\): (正、正、正、正、正、正、正、正、反、反) \\(c_4\\): (正、正、正、正、正、正、正、反、反、反) \\(c_5\\): (正、正、正、正、正、正、反、反、反、反) \\(c_6\\): (正、正、正、正、正、反、反、反、反、反) \\(c_7\\): (正、正、正、正、反、反、反、反、反、反) \\(c_8\\): (正、正、正、反、反、反、反、反、反、反) \\(c_9\\): (正、正、反、反、反、反、反、反、反、反) \\(c_{10}\\): (正、反、反、反、反、反、反、反、反、反) \\(c_{11}\\): (反、反、反、反、反、反、反、反、反、反) 我們可以設定符合某些條件的結果，構成子集合。像是設定至少有五次正面的結果為子集合\\(A\\)，其中有\\(c_1, c_2, c_3, c_4, c_5, c_6\\)，設定正面出現最多次數只有達到5次的結果為子集合\\(B\\)，其中有\\(c_6, c_7, c_8, c_9, c_{10}, c_{11}\\)。子集合\\(A\\)與\\(B\\)涵括集合\\(C\\)的所有結果，所以我們可以稱子集合\\(A\\)與\\(B\\)的聯集，\\(A \\cup B\\)，等於集合\\(C\\)。子集合\\(A\\)與\\(B\\)都有包含的結果種類是\\(c_6\\)，我們可以稱子集合\\(A\\)與\\(B\\)的交集，\\(A \\cap B\\)，代表十枚硬幣的其中五枚正面朝上之結果。更進一步，我們可以只計集合\\(C\\)裡不屬於子集合\\(A\\)的結果，屬於補集\\(\\bar{A}\\)；當然也可以稱呼集合\\(C\\)裡不屬於子集合\\(B\\)的結果，屬於補集\\(\\bar{B}\\)。由此可知，兩個補集的聯集，\\(\\bar{A} \\cup \\bar{B}\\)，涵括的結果沒有\\(c_6\\)，不等於集合\\(C\\)。 3.1.2 機率事件的排列組合 考慮十枚硬幣逐次投擲，紀錄硬幣正面的出現位序，除了全是正面與全是反面的狀況，其他結果有至少十種排列組合。依此可計算\\(c_1\\)到\\(c_{11}\\)，符合每種結果條件的事件數目，各結果事件數目表列如下： 結果代號 計算公式 事件數目 發生機率(\\(P(c_i)\\)) \\(c_1\\) \\(C^{10}_{10}\\) 1 0.001 \\(c_2\\) \\(C^{10}_{9}\\) 10 0.01 \\(c_3\\) \\(C^{10}_{8}\\) 45 0.044 \\(c_4\\) \\(C^{10}_{7}\\) 120 0.117 \\(c_5\\) \\(C^{10}_{6}\\) 210 0.205 \\(c_6\\) \\(C^{10}_{5}\\) 252 0.246 \\(c_7\\) \\(C^{10}_{4}\\) 210 0.205 \\(c_8\\) \\(C^{10}_{3}\\) 120 0.117 \\(c_9\\) \\(C^{10}_{2}\\) 45 0.044 \\(c_{10}\\) \\(C^{10}_{1}\\) 10 0.01 \\(c_{11}\\) \\(C^{10}_{0}\\) 1 0.001 如果硬幣都是依規定鑄造，不會每次投擲都是正面或都是反面，前表所列的每個事件發生機率都是相等的。所以某個結果的事件數目所佔的比例，就是該結果的發生機率，如前表所示。在機率論裡，如同投擲硬幣的案例稱為等機率結果：只要知道如何計算全部與特定結果的事件數目，就能計算特定結果的發生機率。 3.1.3 樣本空間 只要能明確定義一個集合的每個事件，這樣的集合就是樣本空間。所以投擲十枚硬幣，紀錄正面朝上次數的樣本空間是1024種事件。實際實驗的任何一次結果，都會符合其中一種事件。但是讀者要區辨事件是計算機率的元素，實驗結果則是我們對現實世界的理解，各有適合討論的場域。 知道各種結果的發生機率，為了方便計算，我們可以將某種結果寫成\\(P(c_i)\\)。稍早我的定義的子集合\\(A\\)與子集合\\(B\\)，發生機率分別可寫成以下的算式： \\[P(A) = P(c_1) + P(c_2) + P(c_3) + P(c_4) + P(c_5) + P(c_6) = \\sum_{i=1-6}P(c_i)\\] \\[P(B) = P(c_6) + P(c_7) + P(c_8) + P(c_9) + P(c_{10}) + P(c_{11}) = \\sum_{i=6-11}P(c_i)\\] 了解樣本空間的事件排列組合規則，我們就能知道手上的資料符合，或者逼近什麼樣的機率分佈，如此就能決定正確的統計方法。然而現實的統計實務，資料是經過多種條件設定所取得的觀察結果，不似投擲硬幣只有硬幣是否公正而已。數學家很早就了解這種狀況無所不在，提出條件機率(Conditional Probability)的觀念。 3.2 條件機率的計算 3.2.1 蒙提霍爾問題 我們透過一件統計學公案，認識條件機率的觀念與計算方法。二十世紀下半葉，美國統計學界提出著名公案：蒙提霍爾問題(Steve 1975)。蒙提霍爾是二十世紀六十年代著名的美國猜謎節目主持人，這個節目有個知名橋段：主持人向觀眾展示三道門，其中一道門之後是豪華轎車，另外兩道門之後是山羊。每集節目邀請來賓選出正確的門，選到車子現場直接開回家。不過這個橋段有個製造緊張氣氛的安排：來賓先指出其中一道門，接著主持人打開另外兩道門的其中一道，這道門之後一定是山羊。最後就是橋段的高潮，主持人給來賓一次機會，選擇一開始指出的門？還是選擇沒被打開的另一道門？ 統計學者與數學家最關心的是這個節目的來賓：「選擇另一道門是車子的機率有沒有高於一開始選擇的門？」這種情況就是比較兩種選擇的條件機率：已知其中一道門之後是山羊(\\(B\\))，選擇一開始指的門是車子(\\(A\\))之機率；對比選擇另一道門是車子(\\(\\bar{A}\\))之機率。為了方便計算，一般寫成\\(P(A|B)\\)與\\(P(\\bar{A}|B)\\)。同樣的道理，\\(P(\\bar{A}|B)\\)代表已知其中一道門之後是山羊(\\(B\\))，另一道門是車子(\\(\\bar{A}\\))之機率。雖然\\(P(A|B)\\)與\\(P(\\bar{A}|B)\\)的總和是1，但是\\(B\\)也是一種機率事件，因為到底那道門之後是山羊，每一集節目都不會一樣。下表列出所有車子與山羊的狀況： 狀況 1號門 2號門 3號門 1 車 羊 羊 2 羊 車 羊 3 羊 羊 車 節目主持人先讓來賓指出一道門，接著根據情況決定要打開那道門讓觀眾與來賓看山羊。例如車子在1號門之後的狀況，來賓先選擇1號門，接著主持人就隨機打開2號門或3號門；如果是車子不在1號門之後的狀況，來賓先選擇1號門，主持人接著就打開另一道是山羊的門。所以主持人要打開那道門讓觀眾看山羊，也是一種隨機事件。不過主持人打開那道門的機率，與來賓最後選那一道門中車子的機率無關。 3.2.2 貝氏定理 即使不能掌握P(B)，我們可以運用貝氏定理計算\\(P(A|B)\\)與\\(P(\\bar{A}|B)\\)。讀者也許曾經學過貝氏定理的公式，本書談到貝氏定理的地方都是指以下公式： \\[ P(\\theta|D) = \\frac{P(D|\\theta) \\times P(\\theta)}{P(D)} \\] 以蒙提霍爾問題的情境來說，D代表主持人打開有山羊的門，\\(\\theta\\)代表來賓在節目開始的選擇。我們表列來賓先選其中一道門，後來決定不選另一道門的各種結果。節目設計讓來賓一開始只有三種選擇，第一種是先選1號門： 狀況 *1號門 2號門 3號門 結果 1 車 羊 羊 得車 2 羊 車 羊 得羊 3 羊 羊 車 得羊 第二種是先選2號門： 狀況 1號門 *2號門 3號門 結果 1 車 羊 羊 得羊 2 羊 車 羊 得車 3 羊 羊 車 得羊 第三種是先選3號門： 狀況 1號門 2號門 *3號門 結果 1 車 羊 羊 得羊 2 羊 車 羊 得羊 3 羊 羊 車 得車 如果來賓是研究者，\\(P(\\theta)\\)就是來賓的理論預測成功的機率，以上列表顯示來賓一開始的選擇有三種，所以\\(P(\\theta)\\)是1/3。 主持人打開後面是羊的門，就像研究者根據理論收集的資料。來賓預期如果一開始選的門是對的，其餘兩道門會被主持人打開的機率應該是相等的。以一開始選擇1號門且車子就在這道門來說，主持人接著打開2號門或3號門的機率是一樣的，所以\\(P(D)\\)是1/2。因為是以來賓一開始的選擇決定主持人接著開門的樣本空間，一開始選擇的門真的有車，主持人接著開那一道門的機率都是1/2。 \\(P(D|\\theta)\\)代表來賓應該考慮不論自己的猜測是否正確，主持人向觀眾開啟這道門的機率。如果一開始猜車子在1號門，主持人打開2號門可能是其中兩種狀況：第一種是猜對了，車子真的在1號門，主持人接著可以打開的就是2號門或3號門；第二種是猜錯了，車子並不在1號門，主持人能打開的只有後面是羊的那道門。所以如果一開始選擇1號門，接著主持人接著打開有羊的門，是一開始猜測正確的狀況之一，因此機率是1/2。 以上三種機率代入貝氏定理的公式，就能算出來賓得到車子是保持一開始選擇的機率是1/3。也就是說，如果這個節目每一集採用同樣的遊戲流程，決定換門的來賓們大約每三位有兩位能把車子開回家。以貝氏定理算出的事後機率\\(P(\\theta|D)\\)，可做為下次研究的事前機率\\(P(\\theta)\\)，但是很顯然參與蒙提霍爾節目的來賓，並不能靠過去的播出紀錄更新中獎機率3。 嚴謹的心理科學研究根據的假設，必定要提出\\(P(\\theta)\\)的預測，收集資料的分析結果，則是呈現根據此假設獲得手上資料的條件機率\\(P(D|\\theta)\\)。請讀者記住這點：本書各單元範例與習題，所展示的資料之抽樣來源，本質是某種\\(P(D|\\theta)\\)的機率分佈。 3.3 機率分佈 最後我們學習最典型的兩種機率分佈：二項分佈與常態分佈。首先從解析大樂透的中獎機率，了解機率分佈的構成要素。 台灣彩卷大樂透至今已開賣超過十五年，每期玩家可投注01~49任意六個號碼，開獎時看對中多少開出的號碼，對中的號碼越多，獎金越高。根據2019年的遊玩規則，中獎號碼與獎項的對應如下表： 中獎方式 獎項 六個獎號完全相同 頭獎 任五個獎號＋特別號 貳獎 任五個獎號 參獎 任四個獎號＋特別號 肆獎 任四個獎號 伍獎 任三個獎號＋特別號 陸獎 任二個獎號＋特別號 柒獎 任三個獎號 普獎 除了頭獎到肆獎彩金是將當期盈餘依規定的百分比分配，伍獎以下都有固定的中獎金額。為了方便說明，此處先排除有特別號的獎項，計算投注一組能中無特別號獎項的機率。 運用排列組合的計數方法，可知樣本空間的事件總數，也就是投注的號碼組合有\\(C^{49}_6 =\\) 1.398381610^{7}種。六個獎號完全相同只是其中一個事件；中五個獎號的事件有\\(C^{6}_5 \\times C^{49-6}_{6-5} =\\) 258種；中四個獎號的事件有\\(C^{6}_4 \\times C^{49-6}_{6-4} =\\) 1.354510^{4}種；中三個獎號的事件有\\(C^{6}_3 \\times C^{49-6}_{6-3} =\\) 2.468210^{5}種。每個獎項的中獎機率可以用以下的函數公式表示，這道函數就是大樂透不計特別號的中獎機率分佈： \\[ p(x) = \\frac{C^{6}_x \\times C^{49-6}_{6-x}}{C^{49}_6} \\ \\ \\ \\ \\ \\ x = \\{ 3,4,5,6 \\} \\] 公式中的x是隨機變數：x涵括的數字是根據大樂透規則，每期可得獎金的獎號數目，每一注會有多少號碼符合，則由機遇決定。統計學家也稱呼機率分佈是隨機變數可能結果的模型，能以圖像顯示，如圖 3.1： 圖 3.1: 台灣大樂透中獎之機率分佈(不計特別號) 讀者可以運用jamovi示範檔案，調整製造圖3.1的R程式碼，配合這個單元的習題進行修改，讓自已更了解機率分佈。現在我們可以正式認識二項分佈與常態分佈。 3.3.1 二項分佈 二項分佈的隨機變數是一種離散型隨機變數，本單元一開始示範的投擲十枚硬幣之正面朝上次數，就是最佳的例子。 為了說明如何以二項分佈計算投擲十枚硬幣的各種結果之機率，我們先看投擲一枚硬幣所有結果的機率分佈，也就是伯努力分佈(Bernoulli probability distribution)。投擲一枚硬幣只有兩種結果：正面朝上或反面朝上，因此隨機變數值域只有兩個數值：\\({0,1}\\)，分別代表兩種結果。伯努力分佈的機率函數可歸納如下： \\[P_x(p,x) = p^x(1 - p)^{1-x} \\ \\ \\ x = 0, 1\\] 函數的參數\\(p\\)可為0~1之間的任何實數，代表一次事件的出現機率，\\(p = 0.5\\)表示我們認定現在投擲的這枚硬幣是公正硬幣。圖3.2是使用jamovi的Rj製作一枚硬幣擲出正面與反面的機率相等，所有結果的發生機率。讀者可運用jamovi示範檔案，調整投出正面的機率(p)，觀察所有結果的發生機率如何變化？ 圖 3.2: 伯努力機率分佈函數(p = 0.5) 回到十枚硬幣的例子，我們已經知道一次投擲一枚硬幣有兩種結果，一次投擲十枚硬幣不計正反面出現位序，則有11種結果。前面我們已經知道計算數種結果的出現機率，是總計對結果的機率值。了解伯努力分佈能表示投擲一枚硬幣所有結果的出現機率，相同的原理，二項分佈能表示擴展為數枚硬幣，會出現的各種結果之機率。比起伯努力分佈，二項分佈多了一個參數\\(n\\)表示所有的結果總數，隨機變數\\(x\\)依然表示任何一次結果。 根據數學計算公理，二項分佈是伯努力分佈的總和，可歸納為累積機率函數： \\[P(n, p, x) = \\sum^n_{x = 0 - n}p^x\\times(1-p)^{n-x} \\] 根據總機率定理，累積機率函數的總和必為1。任何一個隨機變數\\(X\\)的事件發生機率，就是二項分佈的機率函數： \\[p(n, p, x) = C^n_xp^x\\times(1-p)^{n-x} \\ \\ \\ \\ \\ x \\subset R_x\\] 圖3.3是使用jamovi的Rj製作十枚硬幣的任何一枚，擲出正面與反面的機率相等，所有事件結果的發生機率。讀者同樣可以運用jamovi示範檔案，調整投出正面的機率(p)，觀察所有結果的發生機率如何變化？ 圖 3.3: 二項機率分佈函數(N = 10, p = 0.5) 3.3.2 標準化常態分佈 至此我們應該注意到，如果要用機率分佈表現資料的發生機率，類別變項資料就是運用離散型隨機變數與其機率函數。適合連續變項資料的，則是連續型隨機變數。心理科學有許多測量指標在在一開始被提出時，研究者會設定所有人類的測量結果符合常態分佈，例如智力商數。 許多心理科學行為指標收集的資料不但是連續變數，可測量的值域範圍涵蓋負無限大到正無限大。不過實際的測得的資料，至少有75%會落在一個平均值前後兩個標準差之內的範圍，這個比例的估計是根據柴比雪夫不等式，沒有一種機率分佈會超過這個比例，因此只要找到能正確描述連續變項資料的連續型隨機變數，就能使用其機率分佈計算某個資料數值的發生機率。 有很長一段時間，心理學者們認為智力商數符合常態分佈。如果這個假設符合事實，不論全部人類的智力商數平均值是多少，都能符合某個常態分佈。每個智力商數減去平均值(\\(\\mu\\))，再除以標準差(\\(\\delta\\))，就成為標準化分數。如此轉換不只帶來計算的方便性，也讓心理學者能運用平均值為0，標準差為1的標準化常態分佈，計算從一群人之中，找到在某個智力商數之上或之下的個體之機率。 標準化分數是標準化常態分佈的唯一參數，也是一種連續型隨機變數。標準化分數通常以\\(z\\)表示，將原始分數\\(x\\)轉換為標準化分數的計算公式如下： \\[z = \\frac{x - \\mu}{\\delta} \\ \\ \\ \\ x \\subset R_x\\] 由標準分數-1，累積到標準分數1的機率為0.68，可由標準化常態分佈的累積機率函數求出。這個函數的繪圖如圖3.4： 圖 3.4: 標準化常態分佈累積機率函數 累積機率函數微分之後，就成為機率密度函數。也就是說-1到1之間的累積機率，以機率密度函數畫成的曲線來看，等於兩個分數之間的面積。也就是圖3.5塗成紅色的區域。 圖 3.5: 標準化常態分佈機率密度函數 類似圖3.5的曲線圖，在之後的每個統計單元都會看到。讀者可以使用jamovi示範檔案，演練習題或自行設計題目，了解標準化分數與累積機率的對應。 3.4 總結 機率事件的計算元素能定義為總機率為1的集合，根據計算條件，可定義子集合，以及子集合之間的聯集、補集、以及差集。 運用排列組合原理，能以函數定義各種事件的發生機率，可運用函數計算的事件與發生機率，是為樣本。一個子集合可構成一種樣本空間。 運用貝氏定理，即使不了解理論的機率函數，也能透過樣本的機率函數推算理論成立而能獲得樣本資料的條件機率，以及獲得樣本資料而能肯定理論成立的條件機率。 二項分佈與標準化常態分佈，是類別義項與連續變項的代表性機率函數。 3.5 習題 根據投擲十枚硬幣的表列事件次數，計算子集合\\(A\\)與子集合\\(B\\)的聯集之發生機率：\\(P(A \\cup B)\\)；交集之發生機率：\\(P(A \\cap B)\\)；補集之發生機率：\\(P(\\bar{A} \\cup \\bar{B})\\)。 一幅撲克牌有四種花色與13種點數，「同花順」指抽到相同花色且點數連號的五張牌。運用這個單元示範的機率事件計算方法，計算抽到同花順的機率。 如果主持人蒙提霍爾在某集特別節目，增加為五道門，其餘規則不變。請根據貝氏定理計算選擇後不換門得到轎車，與選擇後換門得到轎車的機率。 蒙提霍爾問題的設定與現實條件差異，體現機率的數學運算不同於現實世界觀察現象發生次數。試著說明你發現的差異關鍵。 參考本單元解析大樂透中獎機率的示範，完成有特別號的各獎中獎機率之機率分佈。 在某個線上遊戲有個寶物抽獎機制，其中一件重要道具的每次抽獎中獎率，官方宣稱平均1000名玩家中，能第一次抽中的機率是\\(1/100\\)。透過網路搜尋，你發現討論抽中這件道具的10000筆不同玩家的留言，有4筆表示第一次抽獎就抽中。請運用二項分佈的機率函數，分析官方的說法符不符合事實？ (探索常態分佈) References "],
["distribution.html", "第4單元 模擬的機率分佈：統計方法的實證作用 4.1 執行模擬腳本 4.2 條件機率之模擬 4.3 母群體與樣本 4.4 二項分佈之模擬 4.5 常態分佈之模擬 4.6 統計學兩大流派 4.7 總結 4.8 習題", " 第4單元 模擬的機率分佈：統計方法的實證作用 統計實務經常運用符合特定理論的隨機方法累積資料，統計量數構成符合特定條件的一個或一組隨機變數。所以研究者能運用適常的機率函數，計算觀察現象的發生機率。所有推論統計方法都有一致的功能：讓研究者判斷現在的資料，符合那一種機率函數？ 我們運用第3單元討論的大樂透中獎機率與蒙提霍爾問題，說明為何母群體(polulation)與樣本(sample)是逼近機率分佈的產物；如何運用模擬方法理解接下來的單元介紹的統計觀念；都是這個單元的重要任務。 4.1 執行模擬腳本 首先說明jamovi模組Rj的使用重點。Rj讓使用者在jamovi執行基本的R程式碼，瀏覽執行結果。本書運用Rj的場合是需要運用模擬程序說明或示範某項概念，不會說明程式碼的撰寫方法。在本書提供的範例程式碼中，有註解提示讀者如何自行修改一行程式碼裡的數值，以測試不同條件的模擬結果。 圖4.1的畫面是一道四則運算的執行示範。畫面左方是R程式碼編輯視窗，右方是執行結果輸出視窗，也是可另做存檔動作的報表。示範畫面有兩行程式碼，分別是四則運算1 - 1與1 + 1。編輯視窗中的程式碼確定編輯完成，要看執行結果只要滑鼠點擊編輯視窗右上角的綠色箭頭。 讀者應該注意到輸出視窗只有一個運算結果，因為第一行程式碼的最前方有註解符號#，只要程式碼任何一行開頭有註解符號，該行程式碼就不會被執行。這個符號的進一步功能是在要執行的程式碼上一行，或者在行末置入註解，提示使用者執行該行程式碼的目的與作用。本書所有使用Rj執行的程式碼，都有這樣的註解提示。 圖 4.1: jamovi Rj的執行畫面 4.2 條件機率之模擬 (模擬換門得車的機率) 在單元3.2，我們透過蒙提霍爾問題認識什麼是條件機率，以及運用貝氏定理計算條件機率。儘管透過計算，我們得知來賓從三道門之中，最後換門而得到轎車的機率，高出最後不換門而得到轎車的機率一倍。然而在現實世界裡，除非蒙提霍爾真的主持上千集甚至上萬集，都跑同一套節目流程讓來賓試運氣，我們無法得知確實有2/3的來賓因為更換門而得到轎車。 模擬機率分佈讓我們可以在數秒之內，製造上萬次節目結尾的狀況。這個模擬程序只要製造兩種隨機變數：來賓一開始的選擇(\\(\\theta\\))；車子在那道門之後(\\(D\\))。因為貝氏定理已經告訴我們，車子所在的門與來賓一開始選擇的門相同的機率(\\(P(\\frac{\\theta}{D})\\))，是車子所在的門與來賓一開始選擇的門不相同的機率(\\(P(\\frac{\\bar \\theta}{D})\\))互為補集，所以兩者總和為1。要模擬的事件就是兩種隨機變數在某一集相同，與兩種不相同，累積的模擬次數就是蒙提霍爾問題的機率分佈逼近結果。 範例檔案提供模擬程序的R程式碼，圖4.2是一次模擬結果，很明顯因換門而得車的次數，高出不換門而得車的次數一倍。讀者下載之後，可以多執行這個程序幾次，每一次結果雖然略有不同，整體顯示換門比不換門得到車子的次數高一倍。這個範例顯示模擬的機率不會完全等於計算的機率，但是現實世界處理的統計問題，可用模擬的機率評估預期結果的發生可能性。 圖 4.2: 蒙提霍爾問題的模擬結果 4.3 母群體與樣本 Population的中文譯名有母群體與母體，行為科學領域常用的是前者，本書採用此譯名；Sample的中文譯名在各種領域都是樣本。這兩個名詞的解釋每本教科書的說法各有不同，我們從正式出版的中文學術辭典節錄相關的說明： 母群體 教育大辭書4：「母群體是根據某些原則來加以認定的所有觀察量數之總數（集合）。」 資訊與通信術語辭典5：「按研究目的所有對象之全體。」 樣本 教育大辭書6：「樣本是指由母群體觀察量數中抽樣而得的部分集合體。」 資訊與通信術語辭典7：「通常為了解一群個體或物質的特性，無法就所有的個體或物質一一檢查，而從其中隨機挑選出來一定數目稱之為樣本。」 兩套辭典的說法都是根據研究的目標來解釋什麼是母群體，什麼是樣本。這些說法必須建立在讀者已經了解研究方向與觀察對象的性質，才能有真正的理解。對於初學者來說，會有疑惑是不是應該先學習研究方法或有初步的研究經驗，才能學習這些統計觀念。 本書建議讀者先擱置這些疑惑，親手操作大樂透中獎機率的模擬程序，再來談談如何認識什麼是母群體，什麼是樣本。單元 3.3 以台灣大樂透為例，介紹如何計算不計特別號的各獎中獎機率分佈。一共有四種獎項，中獎率最高的是中3個號碼，機率是0.018，其次是中4個號碼，機率是0.001，再其次是中5個號碼，機率是3e-06，中獎率最低的是中6個號碼，機率是7.2e-08。最後兩個數字為小數點後6位與後8位。 模擬程序的R程序碼如圖4.3，讀者可下載範例檔案，一邊參考這段說明，一邊操作測試。這個檔案最上方是根據下列公式，計算得出能中至少普獎的期望機率： \\[p(x) = \\frac{C^{6}_x \\times C^{49-6}_{6-x}}{C^{49}_6} x = \\{ 3,4,5,6 \\}\\] 計算結果見表??。 中獎號碼數目 中獎期望機率 3 0.0176504 4 0.0009686 5 0.0000184 6 0.0000001 其後的模擬程序有兩種隨機變數：第一種是某一期的中獎號碼組合numbers；第二種是任何一張當期投注彩卷的號碼組合bet。其中還有一行N &lt;- 1000表示當期總共有1000筆下注號碼，所以模擬程序只要計算每一注中獎號碼數目，再總計中獎號碼數目的累積次數，就可輸出某一期中獎彩卷的機率分佈。 圖 4.3: 台灣大樂透中獎之模擬機率(不計特別號) 這段程式碼有一個迴圈設計，讓模擬程序能重覆執行十次，輸出每一次有中獎的號碼組合數目，也就是模擬十次有一千筆下注彩卷的中獎結果。在圖4.3的輸出數值裡，只有中3個號碼的結果每次出現，中四個號碼的結果只有其中四次出現，而且每一次的模擬機率，不一定等於期望的中獎機率。 讀者只要在模擬程序裡修改某期下注總數，也就是N &lt;-之後的數目，修改幅度越大，就會看到越不一樣的模擬結果。例如改成10000，中3個號碼與中4個號碼會每次都出現，中5個號碼的結果則會出現1或3次。雖然數字改得越大，模擬程序要花更多時間才能完成。測試這個模擬程序的目的，是讓讀者想想，如果每一次下注的彩卷是觀察的對象個體，為何總數要越大才能越逼近計算機率的函數圖形？ 這個範例體現機率論的大數法則(Law of large numbers)，說明一項實驗重複越多次，累積結果的統計值越逼近母群體的參數(parameter)。何謂參數將在下一節說明，這裡我們再次提到的母群體。如果讀到這裡時，讀者己經自行修改多種下注總數，並進行多次測試，就能體會以下對於解釋母群體的函數觀點： 隨機變數涵括所有可能結果，以及給定各隨機變數發生機率之函數。 一開始列出的公式與表列各獎中獎機率，就是一種母群體函數。其中包括隨機變數(中獎號碼數目)，與對應的機率(期望的中獎機率)。模擬程並未製造所有可能的中獎號碼組合，numbers集合隨機產生的1000種號碼組合，再與另一組隨機製造的號碼組合bet，比對中獎號碼數目。1000筆模擬的中獎號碼數目相對比率，構成了樣本。由此案例，我們能理解樣本的函數觀點： 收集的資料屬於母群體函數之隨機變數值域，獲得指定資料的期望機率與母群體函數之事件機率一致。 由函數觀點可知，母群體與樣本是系出同源機率函數，但是樣本的機率函數不是也不必等同母群體的機率函數。從第??單元開始，我們會學到所有統計方法的操作都是根據樣本的機率函數–在許多統計教材裡，被稱為抽樣分佈(Sampling Distribution)。 要能正確運用第1單元提到的統計方法運用指南，除了要理解要處理的資料變項性質，也要了解當下的資料只是長久累積的一部分。大樂透中獎模擬範例也透過一個本書之後的每個單元裡，我們使用統計方法時要留意的問題：由當下的資料獲得的統計量，是不是真的符合母群體機率函數的計算結果？如果無法確定，設計模擬程序，根據執行結果判斷是否適當是最佳的操作方法。 4.4 二項分佈之模擬 許多有數學運算功能的程式語言，都有提供常用機率分佈的相關函數。單元3.3.1展示的二項分佈機率密度函數長條圖，是以R的機率計算函式製作。R也有提供產生指定數量亂數的模擬函式，能用來模擬特定機率分佈。總計模擬函式製造的數值，會發現每個數值的相對次數逼近二項分佈的密度函數，如圖4.4展示模擬10000個數值的機率密度長條圖，以及由二項分佈機率密度函數計算結果產生的長條圖。讀者可以自行修改範例檔案裡面的sim_n，觀察增加數值總量，導致模擬結果越接近機率分佈計算的現象。 圖 4.4: 左：二項機率分佈函數(N = 10, p = 0.5)；右：模擬數值的機率密度函數 4.5 常態分佈之模擬 單元3.3.2簡要介紹標準化常態分佈，是指參數\\(\\mu = 0\\)，與參數\\(\\delta = 1\\)的機率函數計算結果。常態分佈的機率密度函數公式如下： \\[ f(x, \\mu, \\delta) = \\frac{1}{\\delta\\sqrt(2\\pi\\sigma^2)} e^{-\\frac{(x - \\mu)^2}{2\\sigma^2}}\\] 由以上公式可知所有機率分佈函數必有的參數是隨機變數，如同常態分佈，有連續型隨機變數做為參數的機率分佈函數，也有期望值\\(\\mu\\)與\\(\\delta\\)做為參數。期望值是該機率分佈的函數形態，由出現機率最高的隨機變數數值(平均數)與佔至多75%離散區間之內的數值(標準差，根據柴比雪夫不等式)所決定。代表期望值的參數又稱為母數，但是兩者的英文都是parameter。 與如同二項分佈的離散型隨機變數比較，後者雖然也可以計算平均數與標準差，機率分佈型態其實是由隨機變數及其他非期望值的參數所決定。R的常態分佈函式具有根據指定的期望值，製造隨機數值的功能，圖4.5呈現計算的標準化常態分佈函數，以及運用模擬程序製造10000筆隨機數值，繪製的機率密度曲線。讀者可使用示範檔案，自行更改模擬程序的數值數量，函式之內的期望值等，觀察模擬結果的變化。 圖 4.5: 左：標準化常態機率分佈函數；右：模擬數值的機率密度函數 4.6 統計學兩大流派 描述統計(descriptive statistics)與推論統計(inference statistics)的功能：描述統計集合各種呈現資料中“可推論資訊”的技巧，以適當的測量尺度呈現資料的集中與變異。推論統計評估“可推論資訊”符合預測的可能性，或者值得再做探討的價值。 現代統計學的發展歷史與心理學等需要分析資料的科學領域相輔相成。首先被廣泛使用的推論統計方法需要的計算資源較少，這個單元示範的機率分配模擬，直到十幾年前才開始在個人電腦實現，所以需要較多計算資源的統計方法能被更多人使用。Emily Rosa研究結果的示範分析是一種貝氏統計(Bayesian Statistics)的展示，而本書各單元主要介紹的是次數主義統計(Frequenitist Statistics)。 4.6.1 次數主義統計 二項分佈與常態分佈的模擬結果最逼近計算的機率分佈，都是累積至少一萬個隨機數值的狀況，相當於累積一萬次實驗結果。以多次實驗累積的機率分佈推論資訊，正是次數主義的中心思想。所有研究問題都有一個最適合的機率分佈，只要能用最接近的模擬機率分佈評估資料出現的機率，就能用對應的統計方法判斷分析結果。 許多研究問題的機率分配是總計根據某種假設，估計當前資料的發生次數，也就是前面討論貝氏定理時提到的\\(P(D|\\theta)\\)。許多次數主義統計方法原理是建立在這種條件機率分配，但是研究者不必製造模擬數值，只要確定收集資料的條件符合要素，\\(P(D|\\theta)\\)必定接近預設的機率分佈。常見的必要條件有常態性(Normality)與等變異性(Equal variance)，統計學家也開發許多方法，幫助研究者確認手上的資料符合這些條件 ，讓研究者能合理運用統計方法得到的資訊推論。 然而包括心理學在內的多數社會科學研究者，在學習次數主義統計方法的過程中並未充分理解\\(P(D|\\theta)\\)不等於真正想研究的\\(P(\\theta)\\)，近幾年有許多學者更是直接倡議，全面更改使用統計方法慣例(Benjamin et al. 2017; Lakens et al. 2018)。次數主義統計方法雖然是本書的學習重點，每個範例有提示使用建議。 4.6.2 貝氏統計 貝氏統計不必設定\\(P(D|\\theta)\\)符合那一種機率分佈，而是設定\\(P(\\theta)\\)符合的機率分佈，運用現有資料及模擬程序製造可形成機率分佈\\(P(D|\\theta)\\)的隨機數值，以此得出機率分佈\\(P(\\theta|D)\\)，用於推測資料意義或投入下一輪資料分析。因為真實的心理學研究課題包含許多變項，模擬程序需要複雜的演算法與計算資源，目前最常被應用的演算法是馬可夫蒙地卡羅方法(Markov chain Monte Carlo,簡稱MCMC)。 兩大流派的共同點是能用統計方法處理的資料必須是透過隨機程序所得，像是調查使用的抽樣，還有隨機化實驗的分派，\\(P(D|\\theta)\\)才能符合方法原理的設定或可用演算法進行數據模擬。由於兩大流派的差異是處理\\(P(D|\\theta)\\)的方式，所以每種已經發展成熟的次數主義統計方法都有對應的貝氏統計方法。本書設定讀者是統計初學者，不會直接介紹貝氏統計方法，有興趣的讀者可參考本書附錄，接觸貝氏統計方法的學習資源。 4.7 總結 母群體是符合研究目的之理論機率函數，提供製造抽樣分佈模擬數值的參數設定。 4.8 習題 References "],
["onesample.html", "第5單元 單一樣本的推論統計 5.1 預先註冊 5.2 虛無假設顯著性檢定 5.3 單一比率二項檢定 5.4 單一平均數t檢定 5.5 總結 5.6 習題", " 第5單元 單一樣本的推論統計 這個單元介紹第一種推論統計方法：單一樣本檢定。這類方法雖然少見於心理科學研究，但是使用上要注意的基本條件相對較少，是許多統計教材的推論統計入門單元。 透過第1單元登場的Emily Rosa專題研究，我們以這個例子學習假設檢定的基本觀念，並運用二項檢定及單一樣本t檢定分析Emily Rosa的資料。學習t檢定分析的運程，我們將認識另一種連續型隨機變數：t分數，以及其機率函數：t分佈。還有學習信賴區間的觀念與使用方法。 5.1 預先註冊 解說如何使用統計方法之前，請讀者先認識預先註冊(preregistration)(Lindsay, Simons, and Lilienfeld 2016)。預先註冊是一種將科學思考轉化為可徵信報告的流程，就統計實務來說，只有兩個步驟。步驟一：執行分析之前先留下計畫，說明用什麼統計方法分析手上的資料，判斷分析結果的標準是什麼；步驟二：按照計畫程序分析資料，呈現按計畫程序得到的分析結果。 使用任何新的統計方法時，可以透過預先註冊檢視自己有沒有學到正確的使用方法。要留下分析計畫，你必須掌握使用這種統計方法分析手上資料的合理性，以及了解各種分析結果的意義。做法看似很簡單，但是經驗越豐富的研究者，在養成過程中如果沒有建立清楚的觀念，遇到不如預期的資料，經常會陷入天人交戰的局面。只要是按步就班收集資料，無論分析結果是否符合預期，呈現出來都有助科學知識的更新。雖然預先註冊還沒有完全被全世界心理科學家接受，甚至正確認識，正在開始學習統計的你，了解預先註冊的觀念，可以培養判斷分析結論的。 5.2 虛無假設顯著性檢定 我們在單元4.6得知次數主義的要旨，是根據得到某種分析結果的假設為前提(\\(\\theta\\))，評估觀察得到當下資料(D)的條件機率(\\(P(\\frac{D}{\\theta})\\))。這個條件機率能以對應的機率函數計算與模擬，關鍵在於許多問題一開始無法明確預測會得到什麼結果，只能確定最不可能被現在的觀察資料證實的假設，得到當前結果的條件機率(\\(P(\\frac{D}{\\theta})\\))必定不會超過研究者能接受的水準。這種假設被稱為虛無假設(Null Hypothesis，許多統計教材簡記為\\(H_0\\))，以虛無假設的機率分佈計算得到當前結果的條件機率，就是p值。這是虛無假設顯著性檢定的基本思考方式，也是本書介紹的所有統計方法的運作流程。 5.2.1 虛無假設與對立假設 我們在單元3.1.2討論投擲一枚正反面出現機率相等的硬幣，做一系列試驗得到的所有結果之可能機率，可用適當的機率函數計算。這個試驗案例改編自第一個本寫進教科書的假設檢定案例(Fisher 1966)，教科書的作者Ronald Fisher是假設檢定方法的奠基者之一。在Fisher的著作中，他提到曾在一次英式下午茶場合，遇到一位女士宣稱有能力分辨喝下的奶茶是先倒茶再加牛奶，還是先倒牛奶再加茶。當場他設計一個實驗，安排四杯奶茶先倒茶再加牛奶，以及四杯奶茶先倒牛奶再加茶，配成四組請這位女士一一試喝，每一組會先喝到那一種由調製者隨機決定。這個設計如同有四枚硬幣，先不讓對方看投擲的結果，請對方猜正面與反面朝上各有多少枚。 Fisher如此設計的想法，是因為在場沒有人真的知道那位女士的分辨能力。如果這位女士不是靠任意猜測的，我們可以假設她正確分辨一對奶茶調製方法的機率是\\(\\theta_1\\)，根據二項分佈機率函數，她正確分辨所有奶茶如何調製的比率就是\\(P(\\theta_1)\\)。但是既然沒有人知道她的真本事，就算測試結果是百分之百，也無法說服眾人\\(\\theta_1\\)不是50%。當時的Fisher設定另一種假設：如果這位女士是靠猜測的，每一組分辨成功的機率是50%，簡記為\\(\\theta_0\\)。運用單元3.3.1學習到二項分佈計算方法，可以算出要正確猜對至少三對的機率是0.24，全部猜對的機率則是0.01。也就是說，這位女士全靠猜測的話，四組奶茶的測試全部正確的機率不到5%。 Fisher的奶茶試驗所設定的\\(\\theta_0\\)，就是現代進行推論統計分析之前，要設定的虛無假設\\(H_0\\)；茶會當下想測試但是沒人知道的分辨能力就是對立假設(alternative hypothesis, \\(H_1\\))。對於試驗結果的判斷，Fisher的判斷原則來自計算的機率函數，而現代推論統計的判斷原則來自模擬的機率函數。後者是與Roland Fisher同時代的兩位統計學者，Jerzy Neyman與Egon Pearson的貢獻，也是現代推論統計方法需要根據p值判斷分析結果的原因。 要了解如果運用模擬的機率函數進行虛無假設統計檢定，我們設定Fisher的奶茶試驗擴張到20組奶茶，如果這位女士每次測試的答對率有95%，就能模擬虛無假設與對立假設的機率分佈，也就是一次答對率各為0.5與0.95，試驗次數都是20次的二項機率分佈。 以答對率0.95的二項機率分佈製造這位女士可能的答對次數，放到答對率0.5的二項機率分佈，就能算出如果她是靠猜測的，發現這項結果的條件機率，也就是p值。我們知道次數主義的宗旨是長期實驗結果的累積，模擬10000次結果，就能製造10000筆p值。 表 5.1: 10000次奶茶試驗結果的p值累積次數 p_values Freq 0 7341 2e-04 1861 8e-04 615 0.0051 146 0.0208 32 0.0612 4 0.1372 1 由表5.1可知，10000次實驗裡，大於.05的結果有5筆，大於.01的結果總計37筆。許多運用虛無假設顯著性檢定的分析，採用.05或.01為檢定水準的理由來自類似的模擬程序。研究者要採用那一種檢定水準，最佳的策略是了解要測試的虛無假設與對立假設性質。理解計算的與模擬的機率分佈，我們可以歸納兩者性質如下： 虛無假設(\\(H_0\\))：發現當下實驗結果的機率相對較低的實驗結果抽樣分佈。 對立假設(\\(H_1\\))：發現當下實驗結果的機率相對較高的實驗結果抽樣分佈。 運用隨機程序製造符合虛無假設與對立假設的實驗結果抽樣分佈，我們能從圖5.1看到兩者差異。 圖 5.1: 下午茶實驗測試20組的虛無假設(黑色線條)與對立假設(藍色線條)模擬抽樣分佈 5.2.2 型一與型二錯誤率 為了判斷當下的實驗結果是不是屬於虛無假設的抽樣分佈，必定發生兩種判斷失誤：(1)錯誤肯定(False Positive)～判定資料不支持虛無假設，實際上結論錯誤。(2)錯誤否定(False Negative)～判定資料支持虛無假設，實際上結論錯誤。運用虛無假設與對立假設的模擬正確率數值，總計大於正確率0.95的虛無假設數值個數，以及小於正確率0.95的對立假設數值個數，就是10000次實驗的結論為錯誤肯定與錯誤否定的失誤次數。換算為百分比，就是一般所稱的型一錯誤率與型二錯誤率。以一次測試20組奶茶的例子來說，我們設定答對18組是檢定水準，運用示範檔案的模擬程序，就可以得到如表5.2的型一錯誤率(H0 is true, Reject H0)與型二錯誤率(H0 is false, Accept H0)。 表 5.2: 從模擬數值計算型一錯誤率與型二錯誤率 H0 is true H0 is false Reject Ho 0.06 0.64 Accept H0 0.94 0.36 介紹到此，讀者應該發現本書與其他統計教材的不同之處。我們先認識什麼是p值，接著才討論什麼是型一(\\(\\alpha\\))與型二(\\(\\beta\\))錯誤率，而且特意淡化檢定水準的說明。這是為了讓讀者，特別是實務經驗還不豐富的新手了解，p值與型一錯誤率是兩回事。即使以上例子的型一錯誤率剛好等於.05，與常見的檢定水準相同，但是檢定水準其實是由研究者自己設定，型一錯誤率是估計根據真實結果與檢定水準的比較，否定虛無假設卻結論錯誤的最大機率。仔細檢視示範檔案的模擬程式碼，就能知道計算p值與估計犯錯機率的機制，是完全不同的。 相對於型一錯誤率，型二錯誤率指根據檢定水準判斷實際得到的p值，否定對立假設卻不正確的最大機率。能經得起長期考驗的研究結果，型一與型二錯誤率應該越小越好。設定檢定水準體現研究者對型一錯誤率的期許，型二錯誤率與研究者肯定對立假設的正確率互為補集，在統計學裡後者被稱為考驗力(Power)，也就是表5.2的0.64。除了透過儘可能最小的檢定水準得到顯著結果，經得起考驗的研究結果也要有儘可能最大的考驗力。我們在第6單元，將進一步認識什麼是考驗力，以及如何確保研究結果有起碼的考驗力。 5.2.3 母數與無母數檢定 單元4.5提過有母數與無母數的機率分佈的區別，兩者關鍵差異是母群體的機率函數參數有沒有平均數與標準差/變異數。平均數在機率論又名期望值(Expected value)，因為展現隨機試驗所有結果的函數，代表每種結果的隨機變數(x)，與各自發生機率(p)的乘積總和，也就是平均數。機率論裡簡記為\\(E(x)\\)，其中的x正是隨機變數。例如Roland Fisher版本的奶茶試驗，受測者純粹靠猜測的期望值是\\(0\\times\\frac{1}{70} + 1\\times\\frac{16}{70}+2\\times\\frac{36}{70} + 3\\times\\frac{16}{70}+4\\times\\frac{1}{70} = 2\\)。也就是受測者靠著純粹猜測，最可能得到的試驗結果。 在第2單元學習統計量數時，己知平均數是集中量數，與之相關的變異量數是變異數與標準差。既然標準差是變異數的開根號，我們只要了解變異數是每個隨機變數與期望值之差異平方的期望值，如以下公式： \\[Var(x) = E[(x - E(x))^2]\\] 這個公式可以展開為兩種期望值：第一種是隨機變數平方的期望值\\(E(x^2)\\)，第二種是隨機變數期望值的平方\\(E(x)^2\\)，所以這個公式可以寫成： \\[Var(x) = E(x^2) - E(x)^2\\] 我們在單元4.3知道所有統計方法的操作都是根據樣本的機率函數，或者說抽樣分佈。由於平均數與變異數都是母群體機率函數的參數，樣本的機率函數的參數也有這兩者。因此實際資料的平均數與變異數可以視為抽樣分佈的參數估計值，而且有的統計方法就算不清楚母群體的參數是多少，也能使用樣本的平均數與變異數替代。 除了上述的參數估計，母數統計與無母數統計還有一些不同之處，在之後的單元再做介紹。如果兩種方法都可以分析手上的資料，何者較好並沒有絕對的標準，只有何者最適何分析面前的問題。以下用Emily Rosa的專題研究資料，示範無母數統計–二項檢定與母數統計–單一平均數t檢定的分析程序。 5.3 單一比率二項檢定 Emily Rosa在論文中提到，當年先從學校作業發想，找了15位自願參與的治療師進行第一次實驗。之後有記者注意，為了進行採訪，找了包括曾參與第一次實驗部分人士與其他治療師等13位自願者，進行了第二次實驗(Rosa et al. 1998)。因此，本單元以第一次實驗結果示範單一比率二項檢定。 二項檢定只要資料是0到1之內的比率值，配合資料的樣本數就能進行顯著性檢定，判斷資料能不能否定虛無假設。所以Roland Fisher的奶茶測試，可以用這種方法分析。設計與假設和奶茶測試如出一轍的TT測試，當然可以分析結果。 Emily Rosa假設如果治療師真的有本事，答對率應該明顯高於50%，或者十次試驗有超過五次答對。符合假設的母群體機率函數的隨機變數只有兩個數值：1(正確)與0(錯誤)。兩個數值代表的事件機率分別為0.5，因此母群體機率函數的圖示如同圖5.2。 圖 5.2: 單一比率二項檢定之母群體機率函數 Emily Rosa第一次實驗收集了15人共150次回答正確或錯誤的紀錄，使用這個原則進行一萬次模擬，就能得到圖5.3的樣本機率函數。 圖 5.3: 單一比率二項檢定之樣本機率函數 5.3.1 中央極限定理 這個例子體現母群體的機率函數，不必然等於樣本機率函數。只要產生樣本的隨機方法符合母群體機率函數，樣本機率函數就會接近常態分佈。這種現象在機率論稱為中央極限定理，最早由十八世紀的法國數學家亞伯拉罕·棣美弗與十九世紀的皮耶-西蒙·拉普拉斯證明。中央極限定理是今日我們能運用樣本極率函數，或者抽樣分佈，以手中資料進行推論統計的基礎。 我們不必深入了解如何推導中央極限定理，只是必須知道如何判斷模擬的抽樣分佈確實是常態分佈。最直接的方法是判讀分位圖(Q-Q plot)：圖5.4是構成圖5.3的隨機數值，所繪製的分位圖。分位圖的橫軸(Theoretical Quantilies)是隨機數值的標準化分數，也就是z值；縱軸(Sample Quantiles)是隨機數值裡，對應每個z值的累積百分比的分位數。分位圖包括兩種數值的散佈圖，以及通過兩類數值皆為0的迴歸直線。符合中央極限定理的抽樣分佈，繪製出的散佈圖資料點，必定完全貼合迴歸直線。統計語言R有內建分位圖繪圖函式。讀者可自行檢視jamovi模擬程序示範檔案，Rj套件操作視窗裡的qqplot與qqnorm函式。 圖 5.4: 單一比率二項檢定之樣本機率函數分位圖 由此例開始，本書介紹的推論統計方法，只要所根據的抽樣分佈符合常態分佈，都會使用分位圖檢驗抽樣分佈。我們在第6單元，進一步會學到即使完全不知母群體機率函數的模樣，但是只要肯定存在母數(期望值)，樣本機率函數是接近當下樣本平均數與變異數的常態分佈。 5.3.2 檢定程序示範 此處以JASP示範如何使用二項檢定分析Emily Rosa的第一次實驗資料。JASP的Data Library有收錄這筆資料，讀者除了可自行開啟，也可下載本書的JASP示範檔案，觀摩如何使用Frequencies -&gt; Binomial Test模組設定操作。 因為Emily Rosa假設有本事的治療師，正確率應該明顯高於50%，因此設定虛無假設：proportion = 0.5，對立假設：proportion &gt; 0.5。所以設定視窗裡的Test value是0.5，Hypothesis勾選&gt; Test value。 JASP示範檔案之中的顯著性檢定結果回報兩個p值，各自代表正確與錯誤的回答比率都不能否定虛無假設。這些p值的計算是根據假設每次答對率為0.5，累積150次嘗試的二項分佈。再以實際的正確次數或錯誤次數，計算該次數到總次數的相對累積機率，這項p值即代表這群治療師的答對率有沒有高於0.5，如圖5.5是正確次數的二項檢定p值；而圖5.6是錯誤次數的二項檢定p值。讀者可在jamovi模擬程序示範檔案，探索以相同規模重做一次Emily Rosa的實驗，所有治療師要做對多少次，單一比率二項檢定才能肯定他們真有本事？ 圖 5.5: 單一比率二項檢定之正確次數p值視覺化 圖 5.6: 單一比率二項檢定之錯誤次數p值視覺化 5.3.3 估計型一錯誤率 在圖5.5與圖5.6，我們標示符合該抽樣分佈平均值與標準差的常態分佈的藍色曲線。即使模擬的常態分佈幾乎貼合理論的常態分佈，讀者必須區分兩者是不同的機率函數。透過常態分佈的機率函數，我們可以取大於平均Proportion1.64個標準差的總計正確次數，是能不接受當下實驗結果屬於虛無假設抽樣分佈一部分的臨界值。這裡展示估計型一錯誤率的方法是計算所有模擬的Proportion數值總數，總計大於這個臨界值的比例。重覆執行jamovi模擬程序示範檔案數次，讀者會發現型一錯誤率估計值在4%到6%之間變化，平均來說將趨近5%。 5.4 單一平均數t檢定 除了所有治療師的答對率，Emily Rosa也可以用每位治療師的平均正確次數做分析。她與父母等人發表的論文是使用個人的正確次數，分析治療師們到底有沒有真本事。以下示範原始論文使用的單一平均數t檢定分析結果。 稍早在單元 5.2 Roland Fisher的下午茶試驗解說中，我們得知Emily Rosa的實驗參考Fisher的設計，因此治療師們如果是靠運氣面對Emily的測試，每個人能做出正確次數的機率，符合一次試驗正確率p=0.5的二項機率分佈。每位治療師進行十次測試，依靠運氣的正確次數期望值就是\\(10 \\times 0.5 = 5\\)。只要符合此期望值，不論治療師進行幾次測試，或招募多少位治療師，都能製造虛無假設的平均正確次數抽樣分佈。 如果Emily認為有本事的治療師應該有80%以上的答對率，我們就可以設定對立假設正確次數期望值是\\(10 \\times 0.8 = 8\\)。招募的治療師確實有此本事的話，Emily不論做多少次實驗，平均正確次數的抽樣分佈之期望值將接近8次。 5.4.1 抜靴法製造模擬樣本 1970到1980年代之間，越來越多採用統計推論進行研究的領域，面臨多數問題不能確認事先確認母群體機率函數甚至期望值的現實。許多樣本模擬方法應運而生，最重要的兩種方法是蒙地卡羅法(Monte Carlo)與抜靴法(Bootstrap)。本書採用抜靴法製造各推論統計單元範例的抽樣分佈，因為這個方法以實際的樣本資訊做為母群體，設定每個樣本平均值的樣本數，即可重覆再抽樣，形成平均值的抽樣分佈。 Emily Rosa的TT測驗是示範抜靴法的良好入門示範。因為虛無假設與對立假設的來源母群體都是二項分佈，我們可以分別製造虛擬的來源樣本數值，再以這些數值製造模擬實驗結果。可發現以此法製造的模擬抽樣分佈，都會遵循中央極限定理，形成以各假設期望值為中心的常態分佈。 運用虛無假設及對立假計的設定，製造一萬次模擬實驗結果，每次有十五筆平均正確次數，累積出如圖5.7的兩套抽樣分佈直方圖。所有模擬實驗的平均數相當接近預設的期望值，但是變異數並不相同。以兩套抽樣分佈的期望值與變異數繪製常態分佈，可發現兩套抽樣分佈都相當接近常態分佈，顯示每位治療師測試結果的平均值，累積而成的抽樣分佈遵守中央極限定理，趨近常態分佈。 圖 5.7: 單一平均數t檢定平均值抽樣分佈：虛無假設(藍色)、對立假設(紅色)、t分佈判斷標準(黑色垂直線)、常態分佈判斷標準(灰色垂直線) 5.4.2 錯誤率估計比較：常態分佈 vs. t分佈 然而我們為何要使用t分佈–而非常態分佈–判斷統計值屬於虛無假設的條件機率？從型一錯誤率估計結果，能得到一些可供解釋的資訊。圖5.7呈現的兩道垂直線，分別代表t分佈與常態分佈預估的判斷標準，運用jamovi示範檔案的模擬程序，得到型一與型二錯誤率的估計值：常態分佈標準估計型一錯誤率約0.051，估計型二錯誤率約0.0019；t分佈標準估計型一錯誤率約0.0275，估計型二錯誤率約0.008。 如果採納一般約定的0.05顯著水準，常態分佈的標準看起來剛剛好，t檢定似乎過嚴。但是這個原則來自約定促成，並沒有考慮真正的機率計算。我們還必須參考一個條件：這是雙尾還是單尾檢定？ 5.4.3 p值與型一錯誤率計算起點：雙尾 vs. 單尾 連續隨機變數具備等距性質，因此機率函數可計算大於某量數的累積機率，或者小於某量數的累積機率，還可以總和大於較大量數與小於較小量數的累積機率。這些特性讓我們能根據問題性質，決定採雙尾的判斷標準，還是單尾的判斷標準。 採用雙尾的判斷標準，根據資料計算得到的統計值應視為絕對值，如Emily的實驗結果可能是-1.046，也可能是1.046。p值是分別由負無限大累積到-1.046，以及由1.046累積到正無限大的機率總和。運用jamovi的distACTION，可知jamovi與JASP的t檢定模組，為何算出的p值都是0.313。 採用單尾的判斷標準，必須事先設定得到的統計值小於或大於虛無假設期望值。確認累積機率的計算起點，才能從機率分佈得到符合問題狀況的p值。以-1.046來說，單尾t檢定的p值是0.157。 採用雙尾或單尾判斷標準當然也影響型一錯誤率的估計。已知示範檔案的預設判斷標準是雙尾，總計產生自虛無假設的模擬數據，只與大於這虛無假設期望值的標準比較，所以估計錯誤率越接近0.025者，越符合虛無假設的平均數抽樣分佈。 5.4.4 信賴區間 除了運用假設檢定，母數統計的使用者還可以計算信賴區間(confidence interval)，分析當前實驗結果，檢視現在的資料相容虛無或對立假設期望值的機率，與真陰率(\\(1-\\alpha\\))或真陽率(\\(1-\\beta\\))一致的程度。單一平均數t檢定的信賴區間數學表示與R程式碼表列如下： 數學 R \\[\\bar{y} \\pm t_{\\frac{\\alpha}{2}} \\times \\frac{s}{\\sqrt{n}}\\] t_cv &lt;- qt(alpha,df=DF)lci &lt;- sim_TT0 - t_cv* sim_TT0_sd/sqrt(N)uci &lt;- sim_TT0 + t_cv* sim_TT0_sd/sqrt(N) 信賴區間與假設檢定一樣，都是長期累積的可能結果。所以Emily的實驗結果，獲得95%CI [-1.017, 0.350]，也就是說正確次數5有95%的機率與這次結果相容。\\(\\alpha\\)在假設檢定代表最大的錯誤肯定機率；在信賴區間代表所有可能樣本的區間範圍，有多高比例包括假設的期望值。這個比例是\\(1 - \\alpha\\)，因此信賴區間的正式寫法記為%CI。示範檔案的Rj報表最後一行，是總計1萬筆模擬數值的信賴區間，有包括5的總數目。這個數字會隨重新執行不斷變動，但是數字會在9400到9600左右，也就是大約有95%的模擬數值信賴區間，包含代表治療師們只是靠運氣做實驗的平均正確次數。 從模擬程序的圖解可以發現，p值是從逼近的t機率函數取得累積機率。信賴區間與型一或型二錯誤率的估計，則是來自大量模擬數據的累積，也是最接近真實資料的估計方法。因此有學者提倡心理學研究者應該使用信賴區間，而非p值呈現結果(Cumming and Finch 2005)。本書不特別評論那種方法較佳，讀者運用任何方法之前應該思考一個問題：兩種方法都是建立在本質是條件機率\\(P(\\frac{D}{\\theta})\\)的抽樣分佈，加上多數情況是根據期望能否定的虛無假設。如果我們想探討真實的\\(\\theta\\)是否與假設相符，累積大量資料之後，假設檢定與信賴區間能給我們多少有意義的資訊？ 5.4.5 檢定程序示範 JASP與jamovi都有提供完整的t檢定模組，本書提供的jamovi示範檔案與JASP示範檔案都是以雙尾檢定示範。採取雙尾檢定的理由是Emily Rosa做這次實驗之前，並不明瞭治療師們的答對率有多高，只能假設如果真有本事，就不會亂猜；如果沒本事， 平均答對次數應該等於5。如果TT學會有公佈受訓過的治療師們做類似測試有一定的答對率，Emily使用單尾檢定才有意義。 請者可以自行更改t檢定模組中的test value與單尾/雙尾檢定的設定，比較不同設定的分析結果與模擬數據的差異。和二項檢定相比，t檢定要考慮更周詳的分析條件：如參與者人數，每人的測試次數，平均數能做抽樣分佈期望值之估計等等。如果符合可運用的條件，t檢定提供的錯誤率估計更全面，卻也容易被使用者忽略或誤會。 5.5 總結 二項檢定與單一平均數t檢定的抽樣分佈都是來自一定範圍數值的隨機變數，分派數值之間的出現機率，能產生符合虛無假設或對立假設的抽樣分佈。 母數統計與無母數統計的重要區別是所根據的抽樣分佈性質：母數統計的抽樣分佈之形成必定遵守中央極限定理。 任何抽樣分佈必有一個逼近的機率函數，此機率函數是計算p值的來源。 任何抽樣分佈能用適當的模擬程序產生，模擬的抽樣分佈是估計型一或型二錯誤率的唯一可靠來源。 信賴區間來自模擬的抽樣分佈，任何一次實驗結果的信區間應視為所有可能結果裡，抽樣分佈期望值有多高機率相容於此區間內的任何數值。 5.6 習題 (jamovi模擬程序 Emily Rosa第一個實驗) (型一與型二錯誤率) References "],
["paired.html", "第6單元 相依樣本的推論統計 6.1 類別變項的相依樣本推論統計 6.2 連續變項的相依樣本推論統計 6.3 效果量、樣本數與考驗力 6.4 總結 6.5 習題", " 第6單元 相依樣本的推論統計 這個單元以相依樣本(paired measurement)或稱重覆量數(repeated measurement)的案例，介紹無母數統計檢定：McNemar氏檢定；與母數檢定：相依樣本t檢定。透過相依樣本t檢定的案例，我們將認識三個決定推論統計品質的要素：樣本數(N)，效果量(effect size)，與統計考驗力(statistical power)。 6.1 類別變項的相依樣本推論統計 相依樣本是指觀察的個體在一段時間的開始與結束，接受某種處置所表現的行為，所以要處理的資料是一群個體在兩個時間點的表現差異。雖然同一位個體貢獻兩個觀察值，統計分析實驗是處理兩個觀察值的差異分數，所以實作程序與單一樣本推論統計幾乎相同。研究者必須在計畫與報告中，明確掌握樣本性質，才能正確使用相依樣本推論統計方法。 6.1.1 案例介紹 本書介紹的案例改編自 Navarro and Foxcroft (2018) 的示範教材：假想最近的某一次選舉活動，你協助某個剛成立的政黨設計形象廣告。為了測試這個廣告的宣傳效用，你找了100位合格選民，邀請他們試閱廣告給予回饋。其中一項調查是民眾觀看廣告前與看完廣告之後，他們是否認同該政黨的立場，調查結果如下表： 試閱前: 認同 試閱前: 不認同 小計 試閱後: 認同 \\(^a5\\) \\(^b5\\) 10 試閱後: 不認同 \\(^c25\\) \\(^d65\\) 90 小計 30 70 100 與廣告效用最有關係的調查結果，是試閱前後認同立場改變的人數。上表中看廣告之前不認同，看完之後認同的有5人；看廣告之前認同，看完之後不認同的有25人。人數之間的差距似乎顯示這則廣告效用不如預期，你為了說服廣告製作單元，需要使用統計分析，證實你的結論。 6.1.2 McNemar氏檢定 心理學家Quinn McNemar為了分析如同上述案例的調查結果，開發了以他的姓氏命名的檢定方法(McNemar 1947)。這種調查結果雖然從目標對象總計出四種數字，但是能直接回答研究問題的資料，是關鍵處置前後的變化的總計值，也就是上述表格標記b與c的細格。用以下公式計算兩種細格裡的數字，代入運用卡方機率分佈(\\(\\chi^2\\) distribution)，換算為檢定兩個數字是否相等的p值。 \\[ 統計值 = \\frac{(b - c)^2}{b + c} \\] 類別變項的相依樣本抽樣分佈不但沒有期望值，樣本機率函數隨總數而異。根據statkat的指南8，如果b與c的總和不超過20，這個樣本機率函數符合二項分佈；如果b與c的總和超過20，這個樣本機率函數符合自由度為1的卡方機率分佈，如圖6.1。 圖 6.1: 自由度為1的卡方機率密度函數曲線 卡方分佈是一種無方向性的機率分佈，統計值的計數限定由小往大計算，不像前面學到的常態分佈，可由小往大計算，也可由大往小計算，這種特性限制McNemar氏檢定只能設定虛無假設是b等於c，對比對立假設是b不等於c的假設檢定。許多統計教材稱此設定為雙側檢定或雙尾檢定(two-tail test)，如此命名是源於多數推論統計方法是根據如同常態分佈的對稱型機率分佈，稍後的相依樣本t檢定，我們將了解如何根據研究問題的性質，決定假設檢定的方向性設定。 jamovi提供的McNemar氏檢定模組，能以上述統計值公式，計算卡方分數與p值，讓使用者判斷兩項數字之間的差異是否達到必須接受的水準。在jamovi示範檔案裡，我們使用這個模組提供的\\(\\chi^2\\)與\\(\\chi^2 \\ continuity\\ correction\\)兩種計算模式，計算假設檢定的統計數與p值。後者輸出的卡方分數較前者小，但較為可信。這個案例的調查者，需在報告中如此呈現結論： 分析100位試閱民眾觀看廣告前後的認同意見調查，其中70位前後認同一致，5位觀看前不認同但觀看後認同，25位觀看前認同但觀看後不認同。以0.05做為顯著性水準，McNamer氏檢定顯示觀看廣告導致民眾不認同的傾向，明顯高於導致民眾認同的傾向：\\(\\chi^2 (1) = 12.03, p &lt; .001\\)。 6.1.3 McNemar氏檢定的抽樣分佈 讀者可參考卡方機率分佈示範檔案，了解自由度如何決定卡方機率分佈的形態，以及事件累積機率的計算。示範案例的顯著性水準是自由度為1的卡方機率分佈部分累積機率，如圖6.2所示，紅色區域覆蓋的卡方分數，換算的p值都小於0.05。之後的單元中，我們會認識什麼情況的案例，會運用自由度大於1的卡方分佈。 圖 6.2: 自由度為1的卡方機率密度函數曲線及顯著水準累積機率 同樣要運用抽樣分佈的模擬資料，我們才能得到最接近的型一與型二錯誤率估計值。比起單一樣本統計檢定的狀況，相依樣本的例子有明確的對立假設期望值，製造的抽樣分佈可估計型二錯誤率。以3.8414588為判斷標準，可知型一錯誤率在5%以下，型二錯誤率約2%左右。圖6.3是運用jamovi示範檔案產生的模擬結果。 圖 6.3: McNemar Test虛無與對立假設抽樣分佈模擬；黑色垂直線為型一與型二錯誤率判斷基準。 圖6.3顯示無母數分析的特色：抽樣分佈不必然遵守中央極限定理成形。圖中的虛無與對立假設都相差常態分佈甚遠，儘管可以估計型一與型二錯誤率，卻難以整理錯誤率的變化與樣本數或樣本變異數之間的關係。 6.2 連續變項的相依樣本推論統計 心理科學常見的資料型態之一，是以連續尺度測量的相依樣本資料，常見於人類基本心理歷程實驗，以及教學和臨床處遇。除了一種處置的前後測量，受測者在一段時間之內經歷不同處置的表現，也可以採用這種推論統計方法分析，這種測試設計稱為重覆量數(repated measurement)。 6.2.1 案例介紹 這裡使用來自 Moore, McCabe, and Craig (2012) 的示範資料，介紹相依樣本t檢定的使用條件與結果判讀方法。據普度大學兩位學者，紀錄十五名失智症(dementia)患者在一段長期觀察，出現破壞物品行為的次數。研究者認為有月亮的時候，患者出現破壞行為的次數比其他時候多，所以分在一段有月亮與沒有月亮的日期之間，紀錄每位患者出現破壞行為的平均次數。 每位患者的資料可見JASP示範檔案與jamovi示範檔案。這個案例研究有月亮時出現破壞行為的平均次數，有沒有顯著高於其他時候的平均次數。所以抽樣分佈是所有患者兩個時候的次數差異之平均數，簡記為\\(\\bar{D}\\)。如果研究者按步就班收集資料，\\(\\bar{D}\\)的抽樣分佈必定是常態分佈，而來源的母群體的機率函數有多種可能，通常推測期望值等於當下資料的平均數。 6.2.2 樣本平均數的抽樣分佈與t分佈 19世紀末，數學家已經發現t分佈這種機率分佈，直到1908年，William Gosset發表論文指出t分佈符合重覆量數的平均數，形成的抽樣分配。t分佈是連續隨機變數，第一眼看起來像常態分佈，但是t分佈的機率密度函數只有一個參數k，也就是自由度(degree of freedom) 如同多數心理科學問題母群體函數不明，只有樣本平均值的特色。製造相依樣本的平均值抽樣分佈，拔靴法(參考單元(onesample-bootstrap))同樣是最佳方案。我們以失智症患者出現破壞行為的紀錄，透過模擬程序，探討為何要使用t分佈檢定這筆資料的分析結果？以及相依樣本t檢定的自由度為何是n-1？使用拔靶法，從十五位個案紀錄製造10000筆隨機資料。每筆資料都有15對模擬數據，每對數據差異的平均值，累積為10000筆平均值抽樣分佈。 操作jamovi示範檔案的模擬程序，製造虛無假設抽樣分佈，每一對模擬數據都是來自沒有月亮的紀錄；以及對立假設抽樣分佈，每一對模擬數據其中之一來自有月亮的紀錄，另一個來自沒有月亮的紀錄。 圖6.4是採取上設定的模擬結果。該圖顯示以t分佈的判斷水準(黑色垂直線)，估計的型二錯誤率小於以常態分佈設定的判斷水準(灰色垂直線)所估計的錯誤率。 圖 6.4: 樣本差異分數平均數的抽樣分佈 構成對立假設抽樣分佈的模擬平均值差異，是相依樣本統計檢定需要的差異分數(\\(\\bar{D}\\))，一次結果的差異分數要輸入以下公式，才能運用最符合抽樣分佈的機率函數計算p值。 \\[\\frac{\\bar{D} - \\mu_\\bar{D}}{\\frac{s_\\bar{D}}{\\sqrt{N}}}\\] 公式中的N等同樣本數，s是平均值差異的樣本標準差，\\(\\mu_\\bar{D}\\)在相依樣本的例子等於無差異。將虛無假設的模擬數據運用公式轉換，可得到如圖6.5的機率分佈。比較t分佈設定的判斷水準(黑色垂直線)，與常態分佈設定的判斷水準(灰色垂直線)，可見以t分佈估計的型一錯誤率小於常態分佈的估計。對比兩者估計型二錯誤率的反差，代表判定研究結果支持存在有月亮出現破壞行為的論點，以t分佈結論而犯錯的機會將小於以常態分佈結論而犯錯的機會。 圖 6.5: 樣本差異分數平均數的統計數機率分佈 抽樣分佈的標準差，也就是樣本標準誤，可用於計算信賴區間： \\[CI = \\bar{D} \\pm t_{critical} \\times \\frac{s_{\\bar{D}}}{\\sqrt{n}} \\] 由於示範案例的差異分數平均值，超過虛無假設的期望值約六個標準差，造成模擬的信賴區間沒有一項包容虛無假設的期望值。如果這次研究的資料可被再現，能肯定有月亮的日子這類患者有很高的機會出現破壞行為。 最後的問題是為何是自由度為14的t分佈最符合抽樣分佈，而不是自由度為15的t分佈？這個問題可以從理解拔靴法的步驟解答：第一步設定初始樣本數值後，這群數值可總結一個平均值。未知母群體期望值時，以此平均值當做母群體的期望值，是最合理的假設。所以相依樣本的自由度是n - 1，n是資料的樣本數，1代表要估計的母群體期望值。 6.2.3 相依樣本t檢定 JASP與jamovi的相依樣本t檢定操作界面，與單一樣本平均數t檢定幾乎一致，除了沒有Test Value選項。因為運用相依樣本分析的主要目的，是確認差異分數平均值是不是存在。以下透過15位病患紀錄，說明如何設定JASP示範檔案與jamovi示範檔案的相依t檢定程序，以及解讀和呈現分析結果。示範使用雙尾檢定與單尾檢定的時機，與報告的呈現方式。 雙尾檢定 我們想知道兩種時機病患出現破壞行為次數，到底有沒有差異？無論這個差異是多或是少，這時就可以使用雙尾檢定。雙尾檢定的對立假設是\\(\\mu_{\\bar{D}} \\neq 0\\)，也就是兩種時機的平均次數不相等，JASP與jamovi的相依樣本t檢定模組(Paired Samples T-Test)設定視窗中，Hypothesis這一塊都是選擇 $ Measure 1 Measure 2 $ ，模組才會執行雙尾檢定。如果雙尾檢定的判斷水準是p值要小於.05，肯定對立假設的t統計值有正也有負，如圖6.6，對應曲線之下無著色區域的t值。 圖 6.6: 相依樣本t檢定之雙尾檢定：肯定對立假設的t統計數範圍 JASP與jamovi示範檔案的報表設定呈現t統計值(JASP:t;jamovi:statistic)、自由度(df)、p值(p)、還有差異分數平均值(Mean Difference)，以及差異分數的標準誤(SE Difference)。請讀者注意此標準誤數值，相當接近圖??的抽樣分佈變異數的開根號。 勾選Confidence interval並設定估計百分比95%，報表會增加95%信賴區間的結果(JASP:95% CI for Mean Difference;jamovi:95% Confidence Interval)。請注意這個信賴區間不包含0，與假設檢定的結果一致。增加勾選Effect Size，報表會增加這筆資料的效果量(Cohen's d)。效果量的意義在這個單元的最後部分介紹。 根據美國心理學會報告格式指南，一筆推論統計的報告要搭配文字說明，呈現報表內的數值。報告這則案例雙尾檢定結果，寫作示範如下： 15位病患在有月亮時出現破壞行為的平均次數，比其他時間的平均次數多2.43次(有月亮：M = 3.02, SD = 1.50；沒月亮：M = 0.59, SD = 0.46， 95% CI [1.624 3.241])，達到預期的統計顯著水準，t(14) = 6.45, p &lt; .001, d = 1.67。 單尾檢定 現在換個角度探討這個案例：我們想知道有月亮時出現破壞行為次數，有沒有明顯比其他時候多？或者沒有月亮時出現破壞行為次數，有沒有明顯比有月亮時少？這兩個問題對應的對立假設，就變成 \\(\\mu_{\\bar{D}} &gt; 0\\) 與 \\(\\mu_{\\bar{D}} &lt; 0\\) 。在JASP與jamovi的設定視窗，分別選擇 \\(Measure 1 &gt; Measure 2\\) 以及 \\(Measure 1 &lt; Measure 2\\)，就能執行相對的單尾檢定。 如果判斷水準是p值要小於.05，肯定對立假設：有月亮時出現破壞行為次數，比其他時候多的t統計值必為正數，如圖6.7，右圖曲線之下有著色區域的t值；肯定對立假設：無月亮時出現破壞行為次數，比有月亮時少的t統計值必為負數，如圖6.7，左圖曲線之下有著色區域的t值。 圖 6.7: 相依樣本t檢定之單尾檢定：肯定對立假設的t統計數範圍 勾選Confidence interval以及Effect Size，，除了t統計值、自由度、p值、還有差異分數平均值，以及差異分數的標準誤，報表會增加這筆資料的信賴區間與效果量。請留意單尾檢定的信賴區間只會呈現其中一邊的數值，另一邊為正無限大或負無限大。如果分析結果是否定這個案例的對立假設，信賴區間必定包括0。效果量因差異分數的計算方式，會為正數或負數，但是其絕對值必定相等。 6.3 效果量、樣本數與考驗力 最後以本單元相依樣本t檢定的案例，討論效果量、樣本數與考驗力的關係。JASP示範檔案與jamovi示範檔案的報表呈現的效果量，都是Cohen’s d，計算公式是： \\[d = \\frac{\\bar{D} - \\mu_{\\bar{D}}}{s_{\\bar{D}}}\\] 這個公式與t統計數的公式的差異只有分母的樣本標準差，這說明效果量是特指每一次測量結果的標準化數值。即使使用相同的實驗程序，數量相同的樣本，每一次測量的變異數都不會一樣，每次結果以此公式轉換為效果量，才有比較的意義9。 考驗力是型二錯誤率的補集，顯示以當前的判斷水準，能發現顯著結果的機率。和型一錯誤率一樣，要累積多次實驗，我們才能知道某種測量的顯著效應。理想的顯著分析結果，需要事前有足夠資訊，確保研究結果能有起碼的機會被重現。心理科學研究的統計考驗力，一般建議至少要達到0.8或80%。 樣本數大小直接影響考驗力高低，多少樣本才能維持建議的考驗力，則受到效果量的調節。以本單元相依樣本的案例來說，維持雙尾檢定的顯著結果判斷水準不變，再次實驗要得到相同效果量並維持於80%考驗力，需要收集至少6位病患的紀錄。圖6.8是使用jamovi的jpower套件，設定以上述的分析條件，畫出樣本數與效果量在80%考驗力的對應曲線。這條曲線顯示，效果量越小的話，需要越多樣本，才能保障達到該效果量的結果，有達到足夠的考驗力。讀者可下載產製圖6.8的jamovi示範檔案，檢視其他導到相依樣本t檢定考驗力變化的條件。 圖 6.8: 達到指定考驗力之相依樣本t檢定效果量，所需要的樣本數分析。 極少有心理科學的研究題目只需要個位數樣本，就有顯著結果且考驗力至少80%的研究。過去有許多研究者只追求結果顯著與否，忽略考驗力未達建議標準，樣本還未收集到能保障建議考驗力的數量，卻因為已發現顯著結果，就停止實驗並發表。最近十年許多原本被認為具有啟發性的研究結果，再次檢視後發現都是低考驗力的顯著結果，其他研究者難以重現如同原始研究的顯著結果(例如 Camerer et al. 2018; Klein et al. 2018)。因此有學者建議，學習統計的目標應該以能確保研究結果的可再現性為重點，而不是製造能吸引注意的顯著發現(Peng 2015)。 6.4 總結 通常使用相依樣本分析的目的，是要確認重覆量數測得的差異分數是否存在。 McNemar檢定顯現無母數統計的特色：隨機變數平均值的抽樣分佈不保證遵守中央極限定理，形成常態分佈。 無法確定母群體機率函數時，使用t分佈進行母數統計推論，雖有較高的型二錯誤率，但有較保守的型一錯誤率。 研究任務在於確認目標現象的差異分數，效果量是必須呈現的資訊，同時是評估研究設計應收集多少樣本的指標。 6.5 習題 TBA References "],
["independent.html", "第7單元 獨立樣本的推論統計 7.1 無母數：獨立性檢定 7.2 獨立樣本t檢定 7.3 研究設計與統計考驗力 7.4 總結 7.5 習題", " 第7單元 獨立樣本的推論統計 行為與社會科學研究許多種變項是比較背景接近的兩群人士，在兩種不同情境狀況的行為表現。若研究者使用連續尺度收集資料，適用的資料分析方法就是獨立樣本t檢定。這個單元將介紹無母數統計的獨立性檢定，以及母數統計的獨立樣本t檢定。 7.1 無母數：獨立性檢定 這裡示範的獨立性檢定也是運用卡方分佈，判斷研究結果有沒有符合預期。不同於單元6.1介紹的McNemar氏檢定，獨立樣本的卡方檢定比較兩群參與者做出某種反應的比例是否相同，所以統計數的計算原則相同，只是要處理的資料來源較多。以下先介紹示範案例，再說明獨立性檢定的統計數為何較符合自由度為1的卡方分佈，以及示範分析程序。 7.1.1 案例介紹 Rogers與Milkman(2016)發表增加一般大眾使用折價卷行為的研究，其中一項網路實驗請受測者填寫一件問卷，最後有一個額外酬賞題，如果受測者記得回答，就能領到額外賞金。這項實驗比較問卷最後告知有此酬賞的提示，以及完全沒有給予提示的受測者，記得回答酬賞題的人數。 透過這個示範案例JASP示範檔案，我們可以計算有提示的受測者(No cue)與沒有提示的受測者(Have cue)的總人數， 以及每群有回答(respond)或未回答(miss)酬賞題的人數， 整理如表7.1。 表 7.1: Rogers與Milkman(2016)的示範資料。 無提示 有提示 未回答 63 20 有回答 90 132 總人數 153 152 7.1.2 獨立性檢定示範 表7.1的格式有個專有名詞：列聯表。欄位名稱都是放置關鍵獨變項的分組名稱，列名稱是各分組內間斷尺度數值的出現次數。將原始資料轉換成列聯表，目的是分析分組間的次數比例是否相同。所以進行這項研究的分析之前，可如此宣告判斷水準： 如果有提示的受測者點開酬賞題的人數明顯不同於沒提示的受測者，獨立性考驗應該出現小於.05的p值，否則p值應該大於.05。 圖7.1是開啟JASP的Frequencies模組的Contingency Tables操作選單畫面，請留意Columns最好放置關鍵的獨變項欄位。圖7.2的輸出報表上方表格就是列聯表，一般報告顯示各細格實際次數與百分比，這裡為了讓你比對獨立性考驗與適合度考驗的不同，將期望次數一併呈現。 圖 7.1: 卡方檢定獨立性考驗操作設定示範。 圖 7.2: 卡方檢定獨立性考驗報表示範。 圖7.2的下方表格是輔助報告的統計資訊，請留意與多了一個總人數(N)的資訊，示範報告寫作如下： 給予提示確實提高受測者點開酬賞題的行為，\\(\\chi^2\\) (1, N = 305) = 30.220, p &lt; .01。 7.1.3 獨立性檢定的抽樣分佈 我們在jamovi示範檔案設計抽樣分佈的模擬程序，了解為何獨立性檢定的統計數最符合自由度為1的卡方分佈。獨立性檢定的抽樣分佈來自兩群受試者，各自有參與人數(Nocue_N,Havecue_N)，與做出其中一種反應的比例(Miss,Respond)。為了便於說明，這個程序設定兩群人數都是150人，各組會做出其中一種反應的比例如圖7.2的細格期望百分比。如此每一輪模擬製造的隨機數字，代表每一群做出各種回答的人數。這些隨機數字輸入以下公式，就能得到樣本的統計數。公式中i與j分別代表受試者群與反應種類，\\(n_{ij}\\)與\\(p_{ij}\\)分別對應初始設定的各群人數，以及做出某種回答的比例，\\(r_{ij}\\)是模擬程序製造的模擬數字。 \\[\\chi^2 = \\sum_i \\sum_j \\frac{(r_{ij}-n_{ij}p_{ij})^2}{n_{ij}p_{ij}}\\] 同單元6.1.3，我們可以製造上萬筆實驗結果的統計數，繪製如圖7.3的機率函數圖。 圖 7.3: 獨立性檢定抽樣分佈(黑色柱狀圖);自由度為1的卡方分佈(紅色線條);自由度為2的卡方分佈(藍色線條) 計算差異平方和，會發現抽樣分佈與自由度為1的卡方分佈之差異(0.022)，小於抽樣分佈與自由度為2的卡方分佈之差異(0.05)。我們可以將上述公式改寫為以下形式，其中O代表各細格實際次數，E代表各細格期望次數： \\[\\chi^2 = \\sum_i \\sum_j \\frac{(O_{ij}-E_{ij})^2}{E_{ij}}\\] 7.2 獨立樣本t檢定 獨立樣本t檢定是行為科學研究最常見的分析方法，也是本書第一個要模擬兩個抽樣分佈進行解說的方法。因為兩個樣本分別來自不同的樣本分佈，一般統計教材使用獨立樣本t檢定介紹效果量與考驗力，但是少有教材運用模擬程序解析其中的關係。我們將延續單元6.3的課題，探討樣本數、效果量與考驗力的關係。 7.2.1 案例介紹 這裡採用JASP開發團隊執行長Wagenmakers與同事們(2015)嘗試再現德國社會心理學者Topolinski與Sparenberg(2012)的體現認知實驗，公開資料做為獨立樣本t檢定的示範。Topolinski與Sparenberg的實驗是請參與者來實驗室進行12題開放態度量表，題目內容像是「我經常嘗試新奇的外國食物」。參與者以五點量表表達自己對題目主題的開放程度（-2:非常不同意；2:非常同意）。實驗室環境安排如圖7.4，102位參與者答題時要依指示捲動面前的衛生紙捲，其中48位以順時針方向轉動(clockwise)，另外54位以逆時針方向轉動(counter-clockwise)。 圖 7.4: Wagenmakers等人(2017)再現Topolinski與Sparenberg(2012)體現認知實驗的現場設置。 Topolinski與Sparenberg的假設是大多數可轉動的工具開啟方向都是順時針，順時針捲動衛生紙卷的參與者，回答開放態度量表的問題，給的評分應該比逆時針捲動的參與者高。原始研究確實發現顯著較高分的結果，再現研究結果則存放於JASP的示範資料集Kitchen Rolls。 Wagenmakers決定執行研究之前，只有Topolinski與Sparenberg發表的結果，無法確定這次結果會不會一樣，因此適合以母群平均數尚待確認的立場，設定判斷水準。兩組平均數經過假設檢定與信賴區間的分析，可能的結果會是： 如果捲動衛生紙捲的方向會影響參與者的開放態度，兩組平均數的差異雙尾t檢定應該出現小於.05的p值，而且95%信賴區間不會包括0。 至於兩組變異數，我們當然期望是一致的。獨立組設計也預先假設兩組資料彼此獨立，抽樣分配都符合常態分佈。在執行獨立樣本t檢定之前，會檢測這筆資料有沒有違反變異等量假設與常態分佈假設的分析標準。包括JASP與jamovi的多數統計軟體，獨立樣本t檢定都有檢測變異等量與常態分佈的選項，我們可以運用假設檢定的作業原則，設定分析資料未違反兩種假設的判斷水準： (1)如果兩組資料符合變異等量假設，Levene檢驗的p值應該大於.05。(2)如果兩組資料符合常態分佈假設，Shapiro-Wilk檢驗的p值應該大於.05。如果任何一項出現小於.05的p值，必須在報告中討論。 獨立組比較研究通常希望收集的資料各組樣本數目相同，但是通常不能盡如人意。獨立組t檢定有樣本數不相等的版本，如果資料違反變異等量的假設，就該使用不相等的版本。JASP與jamovi設定選項中的Welch，就是可執行此版本的t檢定的選項。 7.2.2 獨立樣本平均數的抽樣分佈 比照單元6.2.2，我們設計獨立樣本平均數t檢定的模擬程序，解說為何假設檢定的統計值與計算信賴區間，應該採用t分數而非z分數。模擬程序原始碼可參考jamovi示範檔案。 首先設定母群體機率函數，除了兩組參與者評分的平均數(counter_mean與clock_mean)與樣本標準差(counter_sd與clock_sd)，再加上兩組人數(counter_n與clock_n)。以這些參數設定每位參與者的評分平均數是均勻分佈的隨機變數，分佈涵括的所有數值的發生機率都相等。逆時針組的最小的發生次數是平均數減1.75倍樣本標準差，最大的發生次數是平均數加1.75倍樣本標準差。順時針組的最小的發生次數是平均數減1.85倍樣本標準差，最大的發生次數是平均數加1.85倍樣本標準差。如圖7.5所示。 圖 7.5: 獨立樣本t檢定母群體機率函數 兩種母群體機率函數分別製造10000筆模擬平均數，依序相減形成\\(\\bar{y_1}-\\bar{y_2}\\)的抽樣分佈，如圖7.6所示，此抽樣分佈的平均數與變異數接近真實資料的統計值，該變異數亦接近於兩群抽樣分佈的合併變異數(pooled variance)所換算的估計標準誤。 圖 7.6: 兩組樣本平均數差異值的抽樣分佈 分位圖(圖7.7)亦顯示此抽樣分佈與常態分佈一致。 圖 7.7: 兩組樣本平均數差異值的抽樣分佈分位圖 將構成抽樣分佈的所有\\(\\bar{y_1}-\\bar{y_2}\\)轉換為標準分數，就能形成如圖7.8的黑色曲線，此曲線與自由度是100的t分佈(藍色曲線)，以及常態分佈(紅色曲線)高度重疊。 圖 7.8: 兩組樣本平均數差異值的標準化分數 vs. 常態分佈 vs. t分佈 計算曲線之間的差異平方和，可發現兩組樣本平均數差異值的標準化分數與t分佈的差異158.44，小於與常態分佈的差異159.33。 7.2.3 示範檔案操作與解讀 開啟JASP示範檔案，點擊報表你會看到T-Tests的Independent Samples T-Test功能選單。圖7.9是根據分析前宣告，勾選與調整的信賴水準。 圖 7.9: JASP獨立樣本雙尾t檢定分析操作設定示範。 接著從圖7.10來看如何從報表擷取要報告的資訊。最上面表格裡的t檢定與信賴區間資料，可比照前面的案例擷取符合報告格式的資訊，以分析前宣告的標準，這項研究並沒有發現顯著差異。中間是變異等量假設與常態分佈假設的檢定結果，根據分析前宣告的標準，兩者都符合假設。最後的描述統計表格，都是在報告中與t檢定統計資訊放置於文字呈現。 圖 7.10: JASP獨立樣本雙尾t檢定報表示範。 這次實驗沒有發現顯著差異，如果是傳統的教學或研究習慣，會簡略報告。但是因為有預先宣告，報告約定要呈現的資訊，才是負責的研究態度。報告寫作範例如下： 順時針捲動的平均評分比逆時針捲動的平均評分高0.072分(順時針：M = 0.641, SD = 0.496；無關聯：M = 0.713, SD = 0.473， 95% CI [-0.118 0.263])，並未達到事先宣告的統計顯著水準，t(100) = 0.754, p = .453, d = 0.149。 因為事前宣告已言明如果通過檢驗標準，就沒有違反變異等量假設與常態分佈假設的問題，在報告中就沒有呈現的必要。 7.3 研究設計與統計考驗力 Wagenmakers等人的再現研究雖然沒有發現顯著結果，但是給我們一個機會探討效果量較小的研究，要如何改進，才能確保能發現顯著差異，又有起碼80%的考驗力。再度開啟考驗力分析的jamovi示範檔案，第二份jPower報表Independent Samples T-Test顯示如果效果量只有0.149的兩組獨立樣本研究，要得p值通過.05判斷水準，且有80%考驗力的顯著結果，Kitchen Roll的兩群參與者人數需要各有至少709人，總共1418人。以圖??的曲線推測，除非這項實驗可測得的效果量能增加，或者降低其望達到的考驗力水準，才能減少參與者的人數。但是降低考驗力水準是本書建議讀者不該採取的策略，即使能得到通過.05判斷水準的p值，實驗結果也不容易再次重現。 圖 7.11: 達到指定考驗力之獨立樣本t檢定效果量，所需要的樣本數分析。 如果Kitchen Roll可以改成重覆量數設計，收集相依樣本的資料。結果依然測得效果量是0.149，同樣採用雙尾檢定與.05判斷水準進行相依樣本t檢定，jPower的估計顯示需要356人，就能確保顯著結果有80%的考驗力，如圖7.12所示。讀者可透過作業問題的引導，比較兩種設計的考驗力分析，了解為何較難再現的心理科學研究，多數是獨立組設計的研究領域。 圖 7.12: 達到指定考驗力之相依樣本t檢定效果量，所需要的樣本數分析。 7.4 總結 TBA 7.5 習題 TBA References "],
["corr-reg.html", "第8單元 相關與迴歸 8.1 案例介紹 8.2 皮爾森相關 8.3 簡單迴歸 8.4 總結 8.5 習題", " 第8單元 相關與迴歸 這個單元介紹兩個連續變項相關程度的皮爾森相關係數，以及如何計算兩者之間的簡單迴歸。以統計方法的發展歷史來說，相關與迴歸的分析方法比假設檢定還早出現。早在十九世紀，Francis Galton(他的表親是提出演化論的Charles Darwin)測量大量不同人種的感官能力與各式運動反應資料，他把各種資料湊成好幾對，繪製成一系列散佈圖(scatterplot)，歸納出第一套計算迴歸係數的方法。他想要運用資料之間的迴歸，分析不同人種之間的差異。儘管理論和研究方法都還不夠成熟，Francis Galton收集與分析資料的方法直接影響智力的研究與智力測驗的發展。 進入大數據時代，資料科學家想做的事情和Francis Galton差不了多少，都是計算一系列變項的相關性，挑出其中最可能預測變項A的變項B，評估兩者迴歸關係的預測能力。在雙變項的世界，變項之間的共同變異(covariance，以下簡稱共變)，是表達變項相關的最佳指標。 8.1 案例介紹 相關係數的示範案例採用五大性格特質的真實資料。五大性格由情緒不穩定性(Neuroticism)、外向性(Extraversion)、經驗開放性(Openness)、親和性(Agreeableness)、盡責性(Conscientiousness)等五種主題的測驗題目組成。示範資料來自 Dolan et al. (2009) 收集500位大學新生的施測資料，JASP與jamovi都有收錄這筆公開資料。除了示範如何利用兩種軟體製作符合寫作格式的相關係數表格，jamovi示範檔也提供相關係數抽樣分佈的模擬程序。 簡單迴歸的示範資料來自 Navarro and Foxcroft (2018) 提供的案例。這項案例紀錄一位新手爸爸在小孩出生後一百天裡，小嬰兒的睡眠時間，爸爸的睡眠時間，以及爸爸用0到100分自評的情緒低落程度。本單元將用JASP與jamovi示範，如何算出以爸爸的睡眠時間預測情緒低落程度的簡單迴歸，以及探討迴歸係數的抽樣分佈。 8.2 皮爾森相關 皮爾森相關係數是兩個變項之間的共變數(Covariance)，與標準差乘積的相除。設定兩個變項來自的母群體都是常態分佈( \\(N(\\mu_X, \\sigma_X), N(\\mu_Y, \\sigma_Y)\\) )，皮爾森相關係數的公式就可寫成： \\[ \\rho_{X,Y} = \\frac{cov(X,Y)}{\\sigma_X \\sigma_Y} \\] 如同五大人格特質的測量資料都是由母群體取隨機抽樣的樣本，任兩個人格特質的相關係數在報告中都記為r，以樣本平均數與標準差計算，計算公式是： \\[ r_{xy} = \\frac{\\sum x_i y_i - n \\bar{x} \\bar{y}}{(n-1)s_x s_y} \\] 表??呈現JASP輸出五大人格特質之間相關係數，讀者可由JASP示範檔或jamovi示範檔了解輸出表格內容的模組設定。我們使用相關係數絕對值最大的盡責性與情緒不穩定性(-0.368)，探討相關係數抽樣分佈的特性。 圖 8.1: 五大人格特質：JASP輸出報表。 8.2.1 相關係數的抽樣分佈 JASP與jamovi提供的相關係數範例資料，都有上百筆的觀察值。原因是樣本數不足一百的隨機樣本所累積的抽樣分佈，不會是像常態分佈一樣的對稱分佈，如此一來就會造成型一錯誤率與考驗力的估計偏差。這樣的狀況需要使用費雪轉換，才能將抽樣分佈轉換為常態分佈。下面的費雪轉換公式，可轉換所有來自同一母群體的所有樣本相關係數。轉換後的樣本相關係數平均數會略高於原始平均數，標準誤必接近\\(\\frac{1}{\\sqrt{n-3}}\\)。 \\[F(r) = \\frac{1}{2} ln \\frac{1+r}{1-r}\\] 以 Dolan et al. (2009) 的五大人格特質資料 為例，如果盡責性與情緒不穩定性相關係數的母群體是\\(\\rho = -0.368\\)，只收集12位學生的資料，模擬10000筆樣本相關係數形成的抽樣分佈如同圖??呈現負偏態的黑色曲線，與分佈中心是-0.368的常態分佈(綠色曲線)有明顯的差異。10000樣本相關係數經過費雪轉換，形成的抽樣分佈(藍色曲線)與平均數是-0.41及標準誤是0.34的常態分佈(紅色曲線)完全契合，此標準誤相當接近以公式\\(\\frac{1}{\\sqrt{n-3}}\\)計算的0.33。 將樣本數增加至如範例資料一樣的500人，樣本相關係數的抽樣分佈就會契合對稱的機率分佈，如圖??代表抽樣分佈的黑色曲線，完全符合抽樣分佈平均數-0.37與標準誤0.04的常態分佈(綠色曲線)。費雪轉轉換後的抽樣分佈(藍色曲線)雖然也符合常態分佈(紅色曲線)，但是估計的期望值-0.39明顯不同於母群體。由此例可知，運用相關係數分析資料的研究，收集的樣本數要達到上百筆。 在相關係數的假設檢定，這道抽樣分佈就是對立假設，相對於平均數 為0的虛無假設。如果這筆樣本不是來自相關係數為0的母群體，只有相當低的機率出自相關係數為0的抽樣分佈。圖(fig:big5-hypo)呈現對立假設與虛無假設的視覺化。 8.2.2 相關係數的強度 圖(fig:big5-hypo)也體現相關係數是一種效果量，所以一次研究得到的相關係數要多高才算理想，必須考慮收集的樣本數。有些統計教材表列所謂的強中弱相關係數，這樣的區分並未考慮樣本數。在此以檢定水準為.05的雙側t檢定為例，圖(fig:corr-crit)列出自由度1到100，與可否定虛無假設的最小相關係數。讀者可運用jaomvi示範檔案，自行修改樣本數與檢定水準的p值，察看符合需要的理想樣本數與相關係數。 8.3 簡單迴歸 迴歸的重要功能是使用自變項(X)的數值，預測依變項(Y)的觀察而獲得的數值。自變項與依變項資料能形成無限多種線性迴歸關係，有最大預測力的迴歸關係，必然涵括自變項與依變項的平均數，且自變項估計的依變項數值(\\(\\hat{Y}\\))與真實的依變項(Y)數值之差異最小。預測數值與真實數值的差異是以差異平方和總計，所以使用這種方式求得的迴歸關係又稱為最小平方迴歸。簡單迴歸關係的自變項必然與迴歸係數(b)與截距(a)構成線性關係，如同下方的迴歸式。 \\[ \\hat{Y} = b \\cdot X + a \\] 如果自變項(X)與依變項(Y)是正相關，截距(a)是以自變項(X)的資料，預測依變項(Y)範圍的最小值，例如圖8.2；如果兩者是負相關，截距(a)是可預測範圍的最大值，例如圖8.3。由此可知迴歸係數與相關係數有密切的關聯，迴歸係數也是一種隨機變數，接著透過範例分析，了解如何運用與迴歸係數有關的參數，評估迴歸關係的預測力。 圖 8.2: 自變項與依變項是正相關的簡單迴歸：以鳶尾花資料庫的versicolor花瓣長度與花瓣寬度為例。 圖 8.3: 自變項與依變項是負相關的簡單迴歸：以鳶尾花資料庫的setosa與versicolor花瓣長度與花萼寬度為例。 8.3.1 範例分析示範 我們使用新手爸爸照顧小嬰兒100天紀錄，運用簡單迴歸以爸爸的睡眠時間預測爸爸情緒低落程度，透過JASP示範檔案與jamovi示範檔案示範如何計算以及擷取報告資訊。JASP使用Regression模組的Linear Regression功能，在設定選單的Dependent Variable匯入dan.grump；Covariates匯入dan.sleep。即可輸出圖8.4的報表：從上面開始第一個表格Model Summary是預設輸出的報告，其中的R(0.903)是自變項與依變項相關係數之絕對值，\\(R^2\\)(0.816)是依變項的變異可被自變項估計的比例，但是這個數值在簡單迴歸並無明顯功能。第二個報表ANOVA需要於設定選單裡的Statistics勾選Model fit，這份報表報告的內容於稍後單元8.3.3介紹。第三個報表Coefficients需要於設定選單裡的Statistics勾選Estimates，這個報表指出這道直線迴歸的截距是125.96，迴歸係數是-8.937，所以報告中的線性迴歸式是： \\[ \\hat{Y} = -8.937 \\cdot X + 125.96 \\] 迴歸係數與截距都是隨機變數，所以報表有兩項數值是否為0的統計檢定結果；Coefficients報表的另一個重點是Standardized這欄的數值只有自變項，這個數值是標準化迴歸係數，也就是相關係數(-0.903)，是以兩個變項資料的標準化分數(\\(z_y, z_x\\))得到的迴歸關係，所以迴歸線必定通過散佈圖座標軸原點，截距必為0。最後一個Descriptivies報表要勾選設定選單裡Statistics的Descriptives，呈現兩個變項的資料個數、平均值、樣本標準差、與樣本標準誤。情緒低落程度的估計標準誤(1.005)除以爸爸睡眠時間的估計標準誤(0.102)，再乘以兩個變項的相關係數(-0.903)，就是迴歸係數-8.9。所以簡單迴歸的迴歸係數與相關係數，能運用以下公式相互換算： \\[r_{xy} = \\frac{se_y}{se_x} \\cdot b\\] 圖 8.4: 新手爸爸育兒紀錄簡單迴歸分析：JASP輸出報表。 8.3.2 迴歸係數的抽樣分佈 我們已知迴歸係數也是一種隨機變數，所以只要改裝相關係數抽樣分佈的模擬程序，就能探索迴歸係數的抽樣分佈。在jamovi示範檔案的模擬程序程式碼首四行的設定參數，除了樣本數與相關係數，還有設定自變項與依變項的樣本標準誤。這段模擬程序以新手爸爸的分析結果設定這四個數值，得到圖??符合常態分佈的抽樣分佈。這道抽樣分佈的平均數是-0.9，標準誤是0.43，極為接近圖8.4的Coefficients報表報告的標準化迴歸係數，以及自變項的標準誤。讀者可以嘗試改變兩個變項的標準誤，形成的抽樣分佈雖然標準誤會有變化，平均數依然接近標準化迴歸係數。 8.3.3 最小平方法 現在可以談談最小平方法的真正意義：有最大預測力的迴歸關係，實際的依變項數值與依變項預測值的差異平方和，最所有迴歸關係之中最小的。首先我們先了解，經由迴歸線得到的依變項預測值，與依變項平均值的差異平方和(\\(\\sum(\\hat{Y} - \\bar{Y})^2\\))，必定小於實際的依變項數值與依變項平均值的差異平方和(\\(\\sum(Y - \\bar{Y})^2\\))，也就是依變項實際資料變異數的分子。前者通常稱為迴歸變異平方和(Sum of Squared Regression，簡記SSR)，後者通常程為總變異平方和(Sum of Squared Total，簡記SST)。 SST與SSR之間的差異等於實際的依變項數值與依變項預測值的差異之平方和(\\(\\sum(Y - \\hat{Y})^2\\))，這些差異值在統計學中被稱為殘差(residual)，總和稱為殘差平方和(Sum of Squared Error，簡記SSE)。除了殘差平方和與迴歸變異平方和的總和必然等於總變異平方和，符合最小平方的迴歸關係，殘差平方和必須小於其他線性迴歸。符合最小平方的迴歸係，也會得到SSR佔SST的比例，等於自變項與依項數的相關係數平方(\\(R^2\\))，所以這個參數又稱為決定係數。 根據圖8.4的ANOVA報表，可知爸爸育兒紀錄迴歸分析的SST是9998.590，SSR與SSE分別是8159.876與1838.714，讀者可檢視jamovi示範檔案資料的三個計算變項：squared.total，squared.regression，squared.residual，其內皆是各筆資料的差異值平方，運用描述統計模組計算所有差異平方和之總和，確實符合上述數值。 8.3.4 簡單迴歸的信賴區間 在前面的單元裡，我們都有學到計算信賴區間的方法。簡單迴歸的信賴區間是指根據設定的信賴水準(如95%)，有多少比例的依變項觀察值，是在迴歸線的預測範圍之內。jamovi線性迴歸模組提供的繪圖選項，能標示信賴區間範圍，如圖8.5的示範。信賴區間的寛度是估計標準誤的倍數，從以下估計標準誤公式可知，正是殘差平方和平均值的開根號。 \\[S_{y \\cdot x} = \\sqrt{\\frac{(Y-\\hat{Y})^2}{n-2}}\\] 圖 8.5: 新手爸爸育兒紀錄簡單迴歸分析：以jamovi繪製迴歸線與95%估計區間。 8.4 總結 TBA 8.5 習題 TBA References "],
["oneway-anova.html", "第9單元 單因子變異數分析 9.1 獨立樣本變異數分析 9.2 多組平均數的分析風險 9.3 總結 9.4 習題", " 第9單元 單因子變異數分析 如果你的分組測試資料歸納為兩個平均值，通常會使用獨立樣本t檢定(單元(independent) )分析兩個平均值的差異。如果歸納的分組測試資料有三個以上平均值，就需要運用變異數分析。這個單元介紹比較組間平均的獨立樣本變異數分析，採用的迴歸式建立抽樣分佈模擬程序，比較多組平均數兩兩比較的模擬結果，理解為何應該使用異數分析。運用迴歸式的理解途逕，我們可以回頭理解本書介紹的所有統計方法，都能透過線性模型理解各種方法的使用原理。 9.1 獨立樣本變異數分析 9.1.1 分解變異數來源 在單元8，我們已經學到運用隨機程序收集的兩個變項資料：Y與X，可以用迴歸式\\(Y = a + b \\cdot X\\)表示。現在設定X是獨變項資料分組的加權值，迴歸式可計算以各組平均數估計依變項的測量結果。迴歸式的截距a是總平均值，迴歸係數b化為各組平均值與總平均值差異的向量，使得X的加權值輸入迴歸式，可得各組平均值。 以三組各有5筆資料為例，總平均是10，各組平均數分別為7,11,13。形成以下表格： Y(觀察值) a(總平均) b(組間差異) X(加權值) 殘差 7.1 10 1.5 -2 0.1 7.2 10 1.5 -2 0.2 6.9 10 1.5 -2 -0.1 7.3 10 1.5 -2 0.3 7.2 10 1.5 -2 0.2 10.7 10 1 1 -0.3 11.2 10 1 1 0.2 11.1 10 1 1 0.1 10.8 10 1 1 -0.2 11.3 10 1 1 0.3 13.1 10 3 1 0.1 13.2 10 3 1 0.2 12.7 10 3 1 -0.3 12.8 10 3 1 -0.2 13.1 10 3 1 0.1 排除上表觀察值的殘差，會發現每個觀察值就等於各組平均值。隨機程序收集的資料必有殘差，所以變異數分析線性模型要做些改良，才能表現一群資料包含的成份。獨立樣本變異數分析的母群體，就能運用以下方程式設定： \\[ Y_{ij} = \\mu + \\alpha_j + \\varepsilon_{i(j)} \\] \\(\\mu\\)等於迴歸式的截距，也就是總平均值。\\(\\alpha\\)是各組平均值與總平均值的差異，下標j標示來自那一組。\\(\\varepsilon_{i(j)}\\)是每個觀察值與各組平均值的差異，不屬於前兩項的計算結果，所以稱為殘差(Residual)。下標i標示屬於那一筆觀察值，括號j表示各組殘差彼此獨立。 \\(\\mu\\)是總平均值的母群體參數，由實際資料得到的平均值通常記為\\(\\bar{Y}\\)。將此符號代入線模型，並移動到等號左邊，線性模型就成為各觀察值與總平均值的變異數來源分解式。\\(\\alpha\\)就是各組平均值與總平均值的變異，\\(\\varepsilon\\)是各觀察值與各組平均值的變異。每種變異都是一種離均差， 將離均差平方加總，即形成以下公式： \\[ \\sum_i \\sum_j (Y_{ij} - \\bar{Y})^2 = \\sum_j(\\bar{Y}_j - \\bar{Y})^2 + \\sum_i \\sum_j(Y_{ij} - \\bar{Y}_j)^2 \\] 每個離均差平方和可簡記為SS，如以下公式表明。變異數分析的目標是根據現在的資料，實驗效果變異的\\(SS_{Variable}\\)明顯區別於殘差變異的\\(SS_{Residual}\\)之可能性。 \\[ SS_{Total} = SS_{Variable} + SS_{Residual} \\] 9.1.2 示範檔案簡介 示範檔案出自Moore, McCabe, 與 Craig (2012) 合著的 Introduction to the practice of statistics。這份研究邀請134位參與者閱覽幾份臉書使用者的社交資訊，評估這些使用者的社交吸引力分數(最低1分；最高7分)。參與者事前並不知道拿到的資訊來自臉書交友人數約為100人、300人、500人、700人、900人的臉書使用者。研究者想知道參與者事前不知情時，評估的社交吸引力分數是否與評估對象的臉書交友人數成正比。這份示範檔案可由以下連結下載：JASP示範檔案0.9.2；jamovi示範檔案。 9.1.3 示範檔案操作與報表解讀 首先建議讀者運用描述統計模組，整理五個分組的吸引力分數平均值與組間變異，並製作直方圖與小提琴圖，預覽五組之間的差異與研究者預期的差距。圖9.1與圖9.2分別是JASP與jamovi的描述統計模組設定與報表畫面。 圖 9.1: 臉書使用者社交吸引力調查描述統計：JASP操作畫面 圖 9.2: 臉書使用者社交吸引力調查描述統計：jamovi操作畫面 由示範畫面可見，除了臉書交友人數最少的這一組，平均評分低其他各組，其他各組的組間變異讓我們無法確定之間的差異不同於研究者的預期？此時使用變異數分析，能幫助我們進一步判斷，圖9.3與圖9.4分別是JASP與jamovi的變異數分析模組(ANOVA -&gt; ANOVA)設定與報表畫面。 圖 9.3: 單因子獨立樣本變異數分析：JASP操作畫面 圖 9.4: 單因子獨立樣本變異數分析：jamovi操作畫面 JASP與jamovi的報表都有呈現效果量\\(\\eta_p^2\\)(partial eta-squared)，請讀者留意模組設定畫面的選項，JASP與jamovi的變異數分析模組呈現效果量的選項設計並不相同。\\(\\eta^2\\)(eta-sqaured)源自相關係數的數學原理，表示組間離均差平方和佔總離均差平方和的比例，比例越高，表示這次研究測得的組間差異越大。\\(\\eta_p^2\\)是\\(\\eta^2\\)的改良版，經過校正讓組間離均差平方和的佔比估計值，更符合實際資料。 圖 9.5: 單因子獨立樣本變異數分析結果表：JASP操作畫面 圖 9.6: 單因子獨立樣本變異數分析結果表：jamovi操作畫面 圖9.5與圖9.6是JASP與jamovi的示範案例輸出報表，除了JASP有在報表左下方標記第三型離均差平方和(Type Ⅲ Sum of Squares)，兩種報表呈現的資訊沒有差異。在正式報告裡，變異數分析結果不會呈現所有的Sum of Squared與Mean Square，最多只會呈現殘差的Mean Square。因為只要根據自由度與F值，就可以用殘差的Mean Square還原所有Sum of Squared與Mean Square。稍後我們會看到報告寫作的示範，接著來看為何可以使用F檢定判斷變異數分析的結果。 9.1.4 殘差變異的抽樣分佈模擬 以分析臉書資料範例來說，變異數分析的虛無假設是各組之間的社交吸引力分數沒有差異，也就是只存在殘差。因此製造只有殘差的模擬抽樣分佈，就可以理解為何變異數分析的統計值是F，以及模擬統計值接近設定的型一錯誤率之程度。 jamovi示範檔案的第一塊Rj報表呈現只有殘差的模擬統計值分佈，如圖9.7的黑色曲線。圖中紅色與藍色曲線是使用F機率函數產生的分佈，紅色曲線的F分佈自由度等於報表(圖9.6)，藍色曲線的F分佈自由度是未減去平均值數目的5與150。計算曲線之間的最小平方差異可確認紅色區線最符合殘差的抽樣分佈。 (fig:sampling distribution of residuals) 圖 9.7: 單因子獨立樣本變異數分析之殘差模擬樣本分佈。 設定型一錯誤率是0.05，我們只要計算模擬統計值有多少比例大於對應該機率的F分數，即可得知從等於分析結果自由度的F 分佈得到的決斷值，經過數次模擬估計的型一錯誤率，多次都是在0.5之下。如果讀者願意花些時間，可嘗試這道模擬程序多次，比較不同F分佈的型一錯誤率估計結果。 9.1.5 變異數分析適用性檢定 資料如果違反組間變異同質(Homogenerity)與樣本分佈常態(Normality)，變異數分析的結果將有偏誤。JASP與jamovi皆提供檢定選項，使用者可得知有無違反兩項條件。例如圖9.8與圖9.9的示範。 圖 9.8: 單因子獨立樣本變異數分析適用性檢定：JASP操作畫面 圖 9.9: 單因子獨立樣本變異數分析適用性檢定：jamovi操作畫面 違反變異同質的資料，檢定結果就會出現小於.05的p值，如同臉書使用者社交吸引力調查。違反樣本分佈常態的資料，分位圖的資料點會偏離迴歸線，因此這份調查資料並未違反這項條件。 對於違反變異同質的資料，使用者可改用Welch校正重新分析。JASP只要開啟圖9.8中的Welch選項；jamovi則改用ANOVA -&gt; One-Way ANOVA分析這筆資料。若使用者認為變異同質檢定的結果在可接受範圍內，可以採用預設的分析結果。 9.1.6 分析後報告 在此以預設分析結果為例，示範在報告中呈現分析結果的規範格式。 交友數100人臉書使用者公開資料，在各組評分得到最低分(M = 3.82, SD = 1.00)，以設定的型一錯誤率不超過.05來看，五組之間的差異是明顯的： \\(F(4,129) = 4.14, MSE = 1.20, p = .003, \\eta_p^2 = 0.114\\)。 9.2 多組平均數的分析風險 最後討論不使用變異數分析，採用已知的方法，如獨立樣本t檢定分析，會有什麼問題？要判斷各組之間有差異，可以進行所有的兩組比較，如果任何一項比較達到設定的顯著水準，就判斷五組之間存在顯著差異。如此一來型一錯誤率該如何設定？ 首先考慮每一項比較都以型一錯誤率是.05，全部比較的型一錯誤率總和是\\(C_2^5 \\times .05\\)，也就是0.5。運用jamovi示範檔案的最後一塊Rj套件進行模擬，可得到近似的估計值。 如果將型一錯誤率以比較的組數調整，也就是.05除以10，每一項比較的p值要小於0.005，才判斷為有差異。這次模擬程序得到所有比較的型一錯誤率總和接近.05。因此如果我們想將各組差異比較的總型一錯誤率控制於.05，變異數分析是比逐項t檢定更為經濟的做法。 9.3 總結 9.4 習題 開發中。 References "],
["jaspjamovi.html", "A JASP與jamovi使用技巧 A.1 JASP與jamovi開發簡史與介面介紹 A.2 jamovi模組安裝 A.3 數值顯示設定 A.4 匯入與匯出資料 A.5 輸出報表", " A JASP與jamovi使用技巧 附錄分享個人JASP與jaomvi的設定與操作技巧，讀者可根據自已的使用習慣與經驗調整。 A.1 JASP與jamovi開發簡史與介面介紹 JASP是由荷蘭阿姆斯特丹大學Eric-Jan Wagenmakers教授領導的團隊於2015年啟動開發專案，核心是R套件路BayesFactor，所以JASP從一開始就是開源軟體。因為核心成員是貝氏統計的專家，JASP不僅能做傳統的統計，也能計算貝式因子，並且操作方式與SPSS一樣。就算你還不明白什麼是貝氏因子，還是能用JASP學習傳統統計方法。 JASP能開啟的檔案格式有已格式化的文字檔(.csv, .txt)、SPSS資料檔(.sav)、以及Libera Office試算表(.ods)。從官方網站下載對應作業系統的安裝程式，安裝成功後打開JASP，切換到File界面(見圖 A.1 )，點選Computer，從存放在個人電腦中的資料夾位置，開啟gss2010.sav。從畫面上你可以看到，你可以透過網路開啟存放在OSF的檔案。0.9版起，Example裡有相當豐富的範例檔案讓使用者學習。 圖 A.1: JASP檔案選單 成功載入資料內容後，JASP自動跳到Common界面，如圖 A.2 。這筆資料有五個欄位，每個欄位名稱之前有一些特別的符號，稍後我們會知道這些符號提示欄位裡的資料，JASP是以什麼樣的尺度處理。 圖 A.2: JASP資料界面 jamovi是由澳洲的軟體工程師Jonathon Love領銜開發的開源統計軟體。Jonathon曾參與開發最早發表的JASP，返回故鄉自立門戶後，與朋友合作開發jamovi。開發理念是讓不擅長寫程式碼的人士，能以接近試算表軟體的介面，使用各種強大的統計功能。 從jamovi官方網站下載對應作業系統的安裝程式並安裝成功之後，會發現介面和JASP有些不一樣，如圖 A.3。 圖 A.3: jamovi起始畫面 使用者需要點擊圖 A.3 紅色圓圈處的三條橫線，才能打開如圖 A.4 的檔案選單，選擇開啟存在本機的檔案。 圖 A.4: jamovi檔案管理選單 A.2 jamovi模組安裝 jamovi使用者可以增加自已或他人開發的模組。只要點選操作介面右上界標記Modules的大十字圖案，就可以開啟模組管理選單(見圖 A.5 )，安裝與更新需要使用的模組。如果使用jamovi的電腦不方便連線管理，使用者可以從官方模組網頁，下載模組的檔案包，從本機安裝。 圖 A.5: jamovi模組管理選單 本書建議讀者安裝的模組有Rj(編寫與執行R程式碼)、jpower(考驗力分析與解說)、distrACTION(機率分佈圖解)、R data sets(R官方示範資料集)、Statkat(統計方法建議諮詢)、learning statistics with jamovi(同名教科書示範資料集)。本書介紹的模擬程序，都是透過jamovi模組Rj執行。有安排模擬程序的示範檔案，相關單元及程式碼內註解，都有說明重要參數設定，讀者只要改變參數數值，就可以觀察模擬結果的變化。 A.3 數值顯示設定 報表顯示的數值都會有小數點之後的數字，推論統計必定產生的p值是最典型有小數點的數值。很多時候匯入的資料會有遺漏值，且因為資料編輯方法的關係，遺漏值會以各式各樣的代碼出現在資料裡。JASP與jamovi都有設定選項，讓使用者因應狀況，調整軟體處理這些數值的方式。 圖 A.6 與圖 A.7 顯示開啟JASP設定選項的方法，以及調整小數點位數，還有設定遺漏值代碼的方法。JASP提供兩種小數點位數調整選項：Display exact p-values打勾之後，報表中的p值都會以精確的數值顯示；不打勾則顯示&lt; .05, &lt; .001等符合報告規範的數字。Fix the numbers of decimals之後的數值，決定除了p值之外，報表的每個數值可呈現之小數點後位數。遺漏值除了程式預設的四種代碼，使用者可根據實際需要，自行設定代碼符號，加入列表後，JASP自動判讀該代碼為遺漏值。 圖 A.6: JASP設定選單–小數點位數設定 圖 A.7: JASP設定選單–遺漏值設定 jamovi的設定選單相對簡潔，圖A.8是設定選單開啟的畫面。Results一欄的Number format與p-value format的功能與JASP的Analysis選單一樣，決定報表中的數值與p值顯示的小數點位數。Import一欄可設定遺漏值預設代碼，看似不如JASP多樣化，jamovi其實以其他功能取代之。 圖 A.8: jamovi設定選單 A.4 匯入與匯出資料 JASP與jamovi都可以匯入 逗號分隔值 (Comma-Separated Values, CSV)的純文字表格資料。兩種程式都預設資料第一列是欄位標題，如同援引自Svetlana Cheusheva的部落格的範例(見圖 A.9 )，CSV資料可匯入任何像Excel一樣的試算表軟體。許多試算表軟體會自動處理匯入的CSV資料，將符合欄位設定的資料轉換為預設格式，JASP和jamovi會以內建演算規則，將每個欄位轉換為類別變項或連續變項。使用者須注意，內建演算規則轉換的變項，不一定符合使用者的計畫設定，進行分析之前必須再次確認。 圖 A.9: 上圖：使用純文字編輯器直接開啟csv檔；下圖：使用Excel自動匯入功能開啟csv檔 許多商用的統計軟體也能匯入CSV表格資料，完成分析的存檔則都是各家的獨門格式，知名的SPSS、SAS皆是如此。JASP與jamovi都能匯入SPSS的存檔，jamovi還可以匯入SAS與STATA。為了促進可重製分析，在此建議可將運用JASP或jamovi匯入商用統計軟體的存檔，再將資料以CSV格式匯出。 A.5 輸出報表 使用者想散佈JASP或jamovi完成的分析報表，除了直接傳送檔案，也可以上傳Open Science Framework(osf.io)。上傳OSF的JASP與jamovi存檔，可直接在網站瀏覽報表內容。有關上傳與管理檔案的方法，可參考本書作者的格落格貼文。圖 A.10 是本書JASP範例存檔在OSF網頁的樣子。 圖 A.10: 在OSF網站瀏覽JASP分析報表，圖中是Emily Rosa的範例。 "],
["data-manipulating.html", "B 資料轉換與過濾 B.1 製造轉換資料的新變項 B.2 設定過濾資料的條件式", " B 資料轉換與過濾 從JASP 0.9版與jamovi 0.9版開始，兩者都有轉換與過濾資料的功能。這些功能的使用方法與一般試算表軟體類似，不過JASP與jamovi各有特色的操作方式。這一節整理官方的說明與示範動畫，讓初次接觸的使用者認識如何使用。 B.1 製造轉換資料的新變項 許多行為科學測驗分數需要經過轉換，才能進行分析。轉換後的分數都要存為新變項，以下整理JASP10與jamovi11的轉換方法。 JASP 轉換作業從資料表格最後一欄(column)旁邊的+開始，如下方的截圖： 設定新變項啟動按鈕 按下+之後，出現如下圖的對話框，使用者自行輸入新變項名稱與決定變項尺度。對話框也提供使用者選擇轉換設定模式，這一節說明以拖放模式為主(手套圖示)。 設定新變項對話框 按下對話框最下面的Create按鈕之後，資料表格上方就會出現如下圖的工作區，下圖的示範資料是第6單元的相依樣本t檢定範例：失智症(dementia)患者在有月亮的日子與沒月亮的日子，出現暴力行為的平均次數。 計算工作區 若要使用單樣本t檢定分析，要將兩個日子的平均次數相減。我們只要如下圖的示範流程，在工作區製造兩個欄位的相減算式： 計算兩個變項的差異值 許多心理學實驗的依變項是反應時間，由於原始反應時間的樣本分佈並非對稱分佈，經常可見的建議是經過對數轉換，再分析轉換後的數值。對數轉換的操作方式如下圖： 對數轉換示範 運用轉換功能也可以將原始分數轉換為標準化分數，如下圖示範。要注意JASP轉換功能不會直接處理遺漏值，需要將資料中的遺漏值轉換之後，標準分數才會是實數。 標準化分數轉換示範 jamovi jamovi提供的轉換設定模式只有編碼模式，如果讀者還沒有足夠的程式碼寫作經驗，建議有較多使用JASP拖放模式的使用經驗，再來嘗試看看。對於自我挑戰企圖較強的讀者，當然鼓勵直接學習。 jamovi的資料轉換功能有兩種：計算(Compute)能運用機率函式製造虛擬資料變項，或綜合複數變項為一個新變項。轉換(Transform)能將數個舊變項資料，根據同一種轉換設定，批次轉換為新變項。jamovi 0.9版起的資料功能選單中，啟動按鈕圖示如圖@ref(fig:jamovi_variables)。 圖 B.1: jamovi的變項計算與轉換功能按鈕。 本書提供許多模擬程序的案例，如果讀者想自行設計，但是還沒有足夠的R程式碼寫作經驗，可以運用計算功能製造多筆虛擬資料，測試同一套推論統計方法的分析結果。製作方法如以下動畫示範： 製造模擬數值 要分析的依變項是許多變項的總和或平均值，只要運用計算功能有提供的函式，依格式置入要轉換的變項名稱，即可產生新的變項分數。如下圖的示範： 計算各種變項平均數並存到新變項 如果要使用同一套轉換設定，轉換至少一個變項的分數，jamovi的轉換功能可以做批次設定，如下方動畫示範： 批次轉換舊變項至新變項 轉換設定可以不只設定一個條件式，如以下動畫示範： 設定多重轉換條件式 B.2 設定過濾資料的條件式 除了遺漏值，許多行為科學研究收集資料時，會設定填充題降低參與者猜中研究目的的機會；也有時候我們只要分析符合特定條件的資料。JASP12與jamovi13各自提供特色的過濾功能，因應 各種使用需要。 JASP 若想根據某個自變項或獨變項的分組設定，只分析其中一組的資料，我們可以運用JASP的一鍵過濾功能，如以下動畫的示範： JASP一鍵過濾 要設定比較複雜的過濾條件，只要按下資料表格最左上方的漏斗圖示，就能開啟計算工作區，設定符合分析需要的過濾條件。相關範例可參考以下動畫示範： JASP設定多重條件示範 jamovi jamovi的過濾設定是增加一個新變項，使用者運用條件式設定新變項的過濾條件，在資料視窗會看到過濾的狀況。如下方的動畫示範： jamovi設定過濾條件 如果有多重過濾條件，只要一次設定多個變項。如下方的動畫示範： jamovi設定多重過濾條件 要用轉換後的分數設定過濾條件，可直接使用jamovi提供的函式。如下方的動畫示範： jamovi以轉換後的分數，設定過濾條件 有時只要擷取符合部分獨變項的資料進行推論統計，jamovi可用計算功能建立符合需要的新變項，使用者只要以此新變項取代舊變項進行分析。如下方的動畫示範： jamovi使用計算功能，重新設定獨變項欄位 JASP計算功能官方示範解說網頁：https://jasp-stats.org/2018/12/18/how-to-compute-columns-in-jasp/↩ jamovi計算功能官方示範解說網頁：https://blog.jamovi.org/2017/11/28/jamovi-formulas.html; 轉換功能官方示範解說網頁：https://blog.jamovi.org/2018/10/23/transforming-variables.html↩ JASP過濾功能官方示範解說網頁： https://jasp-stats.org/2018/06/27/how-to-filter-your-data-in-jasp/↩ jamovi過濾功能官方示範解說網頁： https://blog.jamovi.org/2018/04/25/jamovi-filters.html↩ "],
["writing-report.html", "C 報告寫作指南 C.1 統計資訊呈現建議 C.2 段落內編輯統計資料 C.3 JASP報表編輯 C.4 jamovi報表編輯", " C 報告寫作指南 完成統計分析之後，依照公開報告格式寫作，才能和他人溝通你的分析結論。開發JASP與jamovi的動機之一，是激勵行為與社會科學家使用重製性報告(Reproducible Report)格式寫作科學報告，增進報告內容的可信度。JASP與jamovi呈現的圖表符合APA格式，並能複製到WORD等文書編輯軟體。本書藉此介紹在報告內編輯統計資訊的規範寫作原則。 C.1 統計資訊呈現建議 統計資訊能以文字(text)、表格(table)與圖像(figure)的形式呈現，報告製作者必須考慮想呈現的統計資訊，以什麼形式呈現有最佳效果。寫作學術報告的必備參考書：美國心理學會出版手冊(Publication Manual of the American Psychological Association)，給予想要表格與圖像呈現統計資訊的製作者，設計前應思考的三件事(5.03)。(1) 讀者不易從過多的表格與圖像追蹤需要理解的資訊；(2) 表格與圖像會打斷文字之間的連貫性，影響讀者的理解；(3) 表格與圖像只適合呈現相同維度的統計資訊，以曾經在單元7示範的獨立樣本t檢定為例，檢定結果如圖C.1的第一份表格。 圖 C.1: JASP獨立樣本雙尾t檢定報表示範。 與下列文字相比，讀者可評估那一種形式較適合呈現統計檢定資訊： 用逆時針方向轉動衛生紙捲的參與者，平均評分比用順時針方向轉動的參與者高0.072分(標準誤0.096)，95%信賴區間[-0.118, 0.263]。t檢定顯示兩組評分無顯著差異： t(100) = 0.754, p = 0.453, d = 0.149。 C.2 段落內編輯統計資料 C.3 JASP報表編輯 C.4 jamovi報表編輯 "],
["e58f83e88083e69687e78dbb.html", "參考文獻", " 參考文獻 "]
]
