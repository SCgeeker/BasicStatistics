# 如何比較各班同學的分數？獨立樣本二因子變異數分析 {#twoway-anova}

心理科學經常調查兩個以上的獨變項，如何在依變項的測量發生效用。例如招募不同母語的人士，進行Stroop叫色作業。這類研究通常是重覆量數設計(repeated measurement)，或者一個獨變項是獨立樣本，另一個獨變項是相依樣本的混合設計(mxied design)。分析這些設計的資料都有對應的變異數分析方法，不論獨變項的設計是什麼，研究者採用二因子設計與分析的理由，目的是探討獨變項之間的**交互作用(interaction)**。

這個單元是多因子實驗設計與多元迴歸分析的入門，讓你認識心理科學如何思考多重因素共同影響的問題。最後簡單介紹固定效果(Fixed effect)，與隨機效果(Random effect)，這兩項概念是你進入進階統計要先認識的觀念。

## 示範案例：有效攝取維他命C的方式

我們透過JASP與jamovi都用的範例資料，示範二因子獨立樣本變異數分析。Crampton[-@Cramptongrowthodontoblastsincisor1947]以剛出生的小豬為實驗對象，測試攝取維他命C對小豬牙齒生長的助益。實驗比較間接攝取(混在橘子汁餵食)還是直接攝取(餵食抗壞血酸)較有幫助？並且安排500cc，1000cc，與1500cc三種劑量。60隻小豬被隨機安排到六種攝取方式與劑量安排，所以每組各有十隻。表\@ref(tab:tooth-data)是這筆資料的描述統計，我們可以注意到間接攝取的助益比直接攝取好，而1500cc已達到最佳助益。

```{r tooth-data, out.width='100%', fig.align='center', echo=FALSE}
require(dplyr)
knitr::kable(
  ToothGrowth %>% group_by( 攝取方式 = supp, 劑量 = dose*1000 ) %>% summarise(平均數 = mean(len), 標準差 = round(sd(len),2) ), 
  booktabs = TRUE,
  caption = '示範資料描述統計。OJ：間接攝取，VC：直接攝取。。'
)
```


### 分析前的宣告

按照原始研究者的想法，分析交互作用是想呈現兩種攝取方式，攝取相同劑量維他命C的牙齒生長長度。藉此你可以注意到兩種獨變項在研究者的科學思考裡，有主次之分。這項研究的第一重點是看那種攝取維他命C的方式最有效，其次才是一次吃多少維他命C最有助益。了解交互作用在研究者科學思考中的意義，才能設定有意義的事前宣告，使用最合適的分析方法。

如果二因子變異數分析的交互作用如同預期是顯著的，才有分析主要獨變項的作用在次要獨變項組間變化的意義。這類分析稱為簡單主要效果(simple main effect)，稍後以示範報表說明。

示範研究的事前宣告如下：

> (1)如果攝取方式、劑量與兩個變項的交互作用都能明顯影響受測者的牙齒生長，所有主要效果與交互作用應該出現小於.05的*p*值，否則*p*值大於或等於.05。(2)如果交互作用是顯著的，攝取方式在三種劑量的簡單主要效果，有明顯差異的應該出現小於.05的*p*值，否則*p*值大於或等於.05。


### 示範檔案操作說明

本次使用JASP與jamovi示範，可先下載[JASP示範檔](https://osf.io/t4zd5/)與[jamovi示範檔](https://osf.io/8ujbe/)。兩種軟體都是使用`ANOVA`模組的ANOVA選項，圖\@ref(fig:twoway-anova-operation)呈現兩種軟體的操作選單。你應該注意到只有JASP有設定分析簡單主要效果的選項。


```{r twoway-anova-operation, out.width='100%', fig.cap="二因子獨立樣本變異數分析操作設定示範。圖左是JASP，圖右是jamovi。", fig.align='center', echo=FALSE}
knitr::include_graphics("images/twoway-anova-operation.jpg")
```

### 示範檔案報表解讀

```{r twoway-anova-result, out.width='100%', fig.cap="二因子獨立樣本變異數分析報表示範。圖左是JASP，圖右是jamovi。", fig.align='center', echo=FALSE}
knitr::include_graphics("images/twoway-anova-result.jpg")
```

JASP與jamovi輸出報告獨變項主要效果與交互作用的所有必要資料，與一因子獨立樣本變異數分析相同，不必報告離均差平方和，以及殘差的MSE。因為事前宣告己經說明，我們必須分析與報告JASP的簡單主要效果統計資訊。

### 分析後報告

報告順序以研究者對每個獨變項效果的重視程度排序，能讓讀者抓住研究主題。示範案例的報告如下；

間接攝食維他命C的效果明顯優於直接攝食，*F*(1,54) = 15.57，*p* < .001，*MSE* = 205.35，$\eta^2_p$ = 0.22。攝食劑量越高越有助牙齒生長，*F*(2,54) = 92.00，*p* < .001，*MSE* = 1513.22，$\eta^2_p$ = 0.77。不過兩種攝食方式在最高劑量的差異明顯不比中低劑量，*F*(2,54) = 4.11，*p* = .022，*MSE* = 54.16，$\eta^2_p$ = 0.13。簡單主要效果分析確認兩種方式攝食1500cc維他命沒有顯著差異，*F*(1,54) = 0.002，*p* = .961，*MSE* = 0.032。間接攝取低於1500cc的劑量，效果皆顯著優於直接攝取，1000cc：*F*(1,54) = 13.333，*p* < .001，*MSE* = 175.825；500cc：*F*(1,54) = 10.451，*p* < .01，*MSE* = 175.813。

沒有預先註冊的報告，通常不會完整報告不顯著的統計資訊。但是預先註冊把研究者的關心重點依序排列，不只要報告重要統計量的完整資訊，最好提供可讓讀者查核的資料。

## 獨變項是不是隨機的？

一個獨變項的分組或隨機分派處置，未完全列入可能呈現另一個獨變項顯著差異的所有操作，這樣的獨變項就可能是一種隨機效果(random effect)。另一方面，如果有列入所有可以呈現另一個獨變項顯著差異的所有操作，就可能是一種固定效果(fixed effect)。以示範案例的維他命C劑量為例，1500cc己呈現兩種攝食方式沒有差異，更低的劑量也沒有實驗的必要，這樣的獨變項就是一種固定效果。

相對來說，如果1500cc還有顯著差異，很可能還有更高的劑量才會看不到攝食方式的差異，這麼一來攝食劑量就是一種隨機效果。許多心理科學探討的交互作用都有這樣的特色，因為許多文獻中的獨變項是尚有操作未被測試的隨機效果。

### 交互作用的考驗力

如果是一個獨變項之內的各組平均數差異，除了用差異家族的效果量，也可以用相關家族的效果量，獲得估計考驗力的參考條件。但是兩個以上獨變項交互作用，除非都是獨立效果，Cohen[-@CohenStatisticalpoweranalysis1988]建議的效果量估計方法才有作用。

現在已有適用獨變項是隨機效果的效果量與考驗力方法出現[@westfall_pangea:_2016]，只是你需要了解變異數分析與迴歸是一體兩面的統計方法，才能掌握理解這種方法的闗鍵。至此已經帶你到到不靠需要推導定理的數學方法，所能前進的母數統計邊界。接下來要走下去，就需要你培養好提昇統計思考的意志。


## 習題

開發中。